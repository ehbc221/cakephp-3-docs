

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="HttpClient" lang="en" name="title" />
<meta content="array name,array data,query parameter,query string,php class,string query,test type,string data,google,query results,webservices,apis,parameters,cakephp,meth,search results" lang="en" name="keywords" />

    <title>Http Client - 3.x</title>
    <link href="../_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="../_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="../_static/app.js"></script>

    <link rel="alternate" hreflang="pt_BR" href="../../pt/core-libraries/httpclient.html" /><link rel="alternate" hreflang="es" href="../../es/core-libraries/httpclient.html" /><link rel="alternate" hreflang="ja" href="../../ja/core-libraries/httpclient.html" /><link rel="alternate" hreflang="fr" href="../../fr/core-libraries/httpclient.html" /><link rel="alternate" hreflang="zh" href="../../zh/core-libraries/httpclient.html" /><link rel="alternate" hreflang="tr" href="../../tr/core-libraries/httpclient.html" /><link rel="alternate" hreflang="ru" href="../../ru/core-libraries/httpclient.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 3.5 documentation" href="../_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 3.5 documentation" href="../index.html" />
    <link rel="next" title="Inflector" href="inflector.html" />
    <link rel="prev" title="Hash" href="hash.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
    
    <header class="nav-down">
        <div class="container-fluid hidden-xs hidden-sm">
            <div class="row">
                <div class="col-sm-3 col-md-3">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="../_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-9 col-md-9">
                    <nav class="navbar-right">
                        <ul class="menu">
                            <li class="first">
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
                                <ul class="submenu">
                                    
<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                                </ul>
                            </li>

                            <li><a href="https://cakephp.org/business-solutions">Business Solutions</a></li>
                            <li><a href="https://cakephp.org/writers">Get Paid To Write</a></li>
                            <li><a href="https://cakephp.org/pages/team">Team</a></li>

                            <li>
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
                                <div class="megamenu full">
                                    <div class="row">
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

        
        <div class="container-fluid hidden-md hidden-lg">
            <div class="row">
                <div class="col-sm-6 col-xs-6">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="../_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-6 col-xs-6">
                    <div class="navbar-right">
                        <button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
                            <i class="fa fa-bars toggle-modal"></i>
                        </button>
                    </div>
                    <div id="wrap">
                        <form class="search" action="../search.html" method="get">
                            <input name="q" type="search" placeholder="What are you looking for?">
                            <input id="search_submit" value="Search" type="submit">
                        </form>
                    </div>
                </div>
            </div>
        </div>

        
        <section id="nav-cook" class="hidden-xs hidden-sm">
            <div class="container-fluid ">
                <div class="row ">
                    <div class="col-md-12 back-book">
                        <div class="col-md-5 text-center t-cook-nav p0 hidden-sm hidden-xs">
                            <h2>
                                <a href="../contents.html">
                                    <span class="glyph_range icon-submenu icon-submenu-cook">B</span>
                                    CakePHP 3.5 Red Velvet <strong>Cookbook</strong>
                                </a>
                            </h2>
                        </div>

                        <div class="col-md-4 hidden-sm">
                            <form class="search" action="../search.html" method="get">
                                <input type="hidden" name="check_keywords" value="yes" />
                                <input type="hidden" name="area" value="default" />

                                <div class="col-md-10 p0">
                                    <input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
                                </div>
                                <div class="col-md-2 p0 search-cook">
                                    <button type="submit">
                                        <span class="glyph_range icon-submenu icon-submenu-cook">A</span>
                                    </button>
                                </div>
                            </form>
                        </div>

                        
                        <div class="col-md-3">
                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Language:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
                                                    role="button" aria-haspopup="true" aria-expanded="false" href="#">
                                                        en
                                                        <i class="fa fa-menu-en fa-chevron-down"></i>
                                                    </a>
                                            <ul class="dropdown-menu">
                                            
                                                <li></li>
                                            
                                                <li><a href="../../pt/core-libraries/httpclient.html">pt</a></li>
                                            
                                                <li><a href="../../es/core-libraries/httpclient.html">es</a></li>
                                            
                                                <li><a href="../../ja/core-libraries/httpclient.html">ja</a></li>
                                            
                                                <li><a href="../../fr/core-libraries/httpclient.html">fr</a></li>
                                            
                                                <li><a href="../../zh/core-libraries/httpclient.html">zh</a></li>
                                            
                                                <li><a href="../../tr/core-libraries/httpclient.html">tr</a></li>
                                            
                                                <li><a href="../../ru/core-libraries/httpclient.html">ru</a></li>
                                            
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Version:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">3.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="https://book.cakephp.org/3.0/en">3.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/2.0/en">2.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.3/en/">1.3 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.2/en/">1.2 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.1/en">1.1 Book</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </section>
    </header>

    
    <section class="nav-btn visible-sm visible-xs">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
                </div>

                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
                </div>
            </div>
        </div>
    </section>

    
    <div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title-cookbook" id="modal-header"></h4>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>

<div class="container page-container "><div id="improve-slideout">
        <i class="fa fa-pencil icon-improve"></i>
        <a href="https://github.com/cakephp/docs/edit/3.0/en/core-libraries/httpclient.rst" target="_blank">
            <div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
        </a>
    </div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

    
    <div class="row">
        <div class="col-sm-12 col-md-9 col-md-push-3"><div class="page-contents col-sm-5">
                <h3>Page Contents</h3>
                <ul>
<li><a class="reference internal" href="#">Http Client</a><ul>
<li><a class="reference internal" href="#doing-requests">Doing Requests</a></li>
<li><a class="reference internal" href="#creating-multipart-requests-with-files">Creating Multipart Requests with Files</a><ul>
<li><a class="reference internal" href="#building-multipart-request-bodies-by-hand">Building Multipart Request Bodies by Hand</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sending-request-bodies">Sending Request Bodies</a></li>
<li><a class="reference internal" href="#request-method-options">Request Method Options</a></li>
<li><a class="reference internal" href="#authentication">Authentication</a><ul>
<li><a class="reference internal" href="#using-basic-authentication">Using Basic Authentication</a></li>
<li><a class="reference internal" href="#using-digest-authentication">Using Digest Authentication</a></li>
<li><a class="reference internal" href="#oauth-1-authentication">OAuth 1 Authentication</a></li>
<li><a class="reference internal" href="#oauth-2-authentication">OAuth 2 Authentication</a></li>
<li><a class="reference internal" href="#proxy-authentication">Proxy Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-scoped-clients">Creating Scoped Clients</a></li>
<li><a class="reference internal" href="#setting-and-managing-cookies">Setting and Managing Cookies</a></li>
<li><a class="reference internal" href="#namespace-Cake\Http\Client">Response Objects</a><ul>
<li><a class="reference internal" href="#reading-response-bodies">Reading Response Bodies</a></li>
<li><a class="reference internal" href="#reading-json-and-xml-response-bodies">Reading JSON and XML Response Bodies</a></li>
<li><a class="reference internal" href="#accessing-response-headers">Accessing Response Headers</a></li>
<li><a class="reference internal" href="#accessing-cookie-data">Accessing Cookie Data</a></li>
<li><a class="reference internal" href="#checking-the-status-code">Checking the Status Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div><div class="document-body">
            
  <div class="section" id="namespace-Cake\Http">
<span id="http-client"></span><h1>Http Client<a class="headerlink" href="#namespace-Cake\Http" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="Cake\Http\Client">
<em class="property">class </em><code class="descclassname">Cake\Http\</code><code class="descname">Client</code><span class="sig-paren">(</span><em>mixed $config = []</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Http\Client" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>CakePHP includes a basic but powerful HTTP client which can be used for
making requests. It is a great way to communicate with webservices, and
remote APIs.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.3.0: </span>Prior to 3.3.0 you should use <code class="docutils literal"><span class="pre">Cake\Network\Http\Client</span></code>.</p>
</div>
<div class="section" id="doing-requests">
<h2>Doing Requests<a class="headerlink" href="#doing-requests" title="Permalink to this headline">¶</a></h2>
<p>Doing requests is simple and straight forward.  Doing a GET request looks like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\Http\Client</span><span class="p">;</span>

<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>

<span class="c1">// Simple get</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/test.html&#39;</span><span class="p">);</span>

<span class="c1">// Simple get with querystring</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/search&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;q&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;widget&#39;</span><span class="p">]);</span>

<span class="c1">// Simple get with querystring &amp; additional headers</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/search&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;q&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;widget&#39;</span><span class="p">],</span> <span class="p">[</span>
  <span class="s1">&#39;headers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;X-Requested-With&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;XMLHttpRequest&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>Doing POST and PUT requests is equally simple:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Send a POST request with application/x-www-form-urlencoded encoded data</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;http://example.com/posts/add&#39;</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;testing&#39;</span><span class="p">,</span>
  <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;content in the post&#39;</span>
<span class="p">]);</span>

<span class="c1">// Send a PUT request with application/x-www-form-urlencoded encoded data</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">&#39;http://example.com/posts/add&#39;</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;testing&#39;</span><span class="p">,</span>
  <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;content in the post&#39;</span>
<span class="p">]);</span>

<span class="c1">// Other methods as well.</span>
<span class="nv">$http</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
<span class="nv">$http</span><span class="o">-&gt;</span><span class="na">head</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
<span class="nv">$http</span><span class="o">-&gt;</span><span class="na">patch</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-multipart-requests-with-files">
<h2>Creating Multipart Requests with Files<a class="headerlink" href="#creating-multipart-requests-with-files" title="Permalink to this headline">¶</a></h2>
<p>You can include files in request bodies by including a filehandle in the array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;http://example.com/api&#39;</span><span class="p">,</span> <span class="p">[</span>
  <span class="s1">&#39;image&#39;</span> <span class="o">=&gt;</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">&#39;/path/to/a/file&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The filehandle will be read until its end; it will not be rewound before being read.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">For compatibility reasons, strings beginning with <code class="docutils literal"><span class="pre">&#64;</span></code> will be evaluated
as local or remote file paths.</p>
</div>
<p>This functionality is deprecated as of CakePHP 3.0.5
and will be removed in a future version. Until that happens, user data being passed
to the Http Client must be sanitized as follows:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;http://example.com/api&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;search&#39;</span> <span class="o">=&gt;</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">),</span> <span class="s1">&#39;@&#39;</span><span class="p">),</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>If it is necessary to preserve leading <code class="docutils literal"><span class="pre">&#64;</span></code> characters in query strings, you can pass
a pre-encoded query string from <code class="docutils literal"><span class="pre">http_build_query()</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;http://example.com/api&#39;</span><span class="p">,</span> <span class="nb">http_build_query</span><span class="p">([</span>
    <span class="s1">&#39;search&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">),</span>
<span class="p">]));</span>
</pre></div>
</div>
<div class="section" id="building-multipart-request-bodies-by-hand">
<h3>Building Multipart Request Bodies by Hand<a class="headerlink" href="#building-multipart-request-bodies-by-hand" title="Permalink to this headline">¶</a></h3>
<p>There may be times when you need to build a request body in a very specific way.
In these situations you can often use <code class="docutils literal"><span class="pre">Cake\Http\Client\FormData</span></code> to craft
the specific multipart HTTP request you want:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\Http\Client\FormData</span><span class="p">;</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>

<span class="c1">// Create an XML part</span>
<span class="nv">$xml</span> <span class="o">=</span> <span class="nv">$data</span><span class="o">-&gt;</span><span class="na">newPart</span><span class="p">(</span><span class="s1">&#39;xml&#39;</span><span class="p">,</span> <span class="nv">$xmlString</span><span class="p">);</span>
<span class="c1">// Set the content type.</span>
<span class="nv">$xml</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">(</span><span class="s1">&#39;application/xml&#39;</span><span class="p">);</span>
<span class="nv">$data</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$xml</span><span class="p">);</span>

<span class="c1">// Create a file upload with addFile()</span>
<span class="c1">// This will append the file to the form data as well.</span>
<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$data</span><span class="o">-&gt;</span><span class="na">addFile</span><span class="p">(</span><span class="s1">&#39;upload&#39;</span><span class="p">,</span> <span class="nb">fopen</span><span class="p">(</span><span class="s1">&#39;/some/file.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">));</span>
<span class="nv">$file</span><span class="o">-&gt;</span><span class="na">contentId</span><span class="p">(</span><span class="s1">&#39;abc123&#39;</span><span class="p">);</span>
<span class="nv">$file</span><span class="o">-&gt;</span><span class="na">disposition</span><span class="p">(</span><span class="s1">&#39;attachment&#39;</span><span class="p">);</span>

<span class="c1">// Send the request.</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span>
    <span class="s1">&#39;http://example.com/api&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$data</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;headers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="nv">$data</span><span class="o">-&gt;</span><span class="na">contentType</span><span class="p">()]]</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sending-request-bodies">
<h2>Sending Request Bodies<a class="headerlink" href="#sending-request-bodies" title="Permalink to this headline">¶</a></h2>
<p>When dealing with REST API&#8217;s you often need to send request bodies that are not
form encoded. Http\Client exposes this through the type option:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Send a JSON request body.</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span>
  <span class="s1">&#39;http://example.com/tasks&#39;</span><span class="p">,</span>
  <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">),</span>
  <span class="p">[</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;json&#39;</span><span class="p">]</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">type</span></code> key can either be a one of &#8216;json&#8217;, &#8216;xml&#8217; or a full mime type.
When using the <code class="docutils literal"><span class="pre">type</span></code> option, you should provide the data as a string. If you&#8217;re
doing a GET request that needs both querystring parameters and a request body
you can do the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Send a JSON body in a GET request with query string parameters.</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span>
  <span class="s1">&#39;http://example.com/tasks&#39;</span><span class="p">,</span>
  <span class="p">[</span><span class="s1">&#39;q&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;_content&#39;</span> <span class="o">=&gt;</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">)],</span>
  <span class="p">[</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;json&#39;</span><span class="p">]</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="request-method-options">
<span id="http-client-request-options"></span><h2>Request Method Options<a class="headerlink" href="#request-method-options" title="Permalink to this headline">¶</a></h2>
<p>Each HTTP method takes an <code class="docutils literal"><span class="pre">$options</span></code> parameter which is used to provide
addition request information.  The following keys can be used in <code class="docutils literal"><span class="pre">$options</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">headers</span></code> - Array of additional headers</li>
<li><code class="docutils literal"><span class="pre">cookie</span></code> - Array of cookies to use.</li>
<li><code class="docutils literal"><span class="pre">proxy</span></code> - Array of proxy information.</li>
<li><code class="docutils literal"><span class="pre">auth</span></code> - Array of authentication data, the <code class="docutils literal"><span class="pre">type</span></code> key is used to delegate to
an authentication strategy. By default Basic auth is used.</li>
<li><code class="docutils literal"><span class="pre">ssl_verify_peer</span></code> - defaults to <code class="docutils literal"><span class="pre">true</span></code>. Set to <code class="docutils literal"><span class="pre">false</span></code> to disable SSL certification
verification (not recommended).</li>
<li><code class="docutils literal"><span class="pre">ssl_verify_peer_name</span></code> - defaults to <code class="docutils literal"><span class="pre">true</span></code>. Set to <code class="docutils literal"><span class="pre">false</span></code> to disable
host name verification when verifying SSL certificates (not recommended).</li>
<li><code class="docutils literal"><span class="pre">ssl_verify_depth</span></code> - defaults to 5. Depth to traverse in the CA chain.</li>
<li><code class="docutils literal"><span class="pre">ssl_verify_host</span></code> - defaults to <code class="docutils literal"><span class="pre">true</span></code>. Validate the SSL certificate against the host name.</li>
<li><code class="docutils literal"><span class="pre">ssl_cafile</span></code> - defaults to built in cafile. Overwrite to use custom CA bundles.</li>
<li><code class="docutils literal"><span class="pre">timeout</span></code> - Duration to wait before timing out in seconds.</li>
<li><code class="docutils literal"><span class="pre">type</span></code> - Send a request body in a custom content type. Requires <code class="docutils literal"><span class="pre">$data</span></code> to
either be a string, or the <code class="docutils literal"><span class="pre">_content</span></code> option to be set when doing GET
requests.</li>
<li><code class="docutils literal"><span class="pre">redirect</span></code> - Number of redirects to follow. Defaults to <code class="docutils literal"><span class="pre">false</span></code>.</li>
</ul>
<p>The options parameter is always the 3rd parameter in each of the HTTP methods.
They can also be used when constructing <code class="docutils literal"><span class="pre">Client</span></code> to create
<a class="reference internal" href="#http-client-scoped-client"><span class="std std-ref">scoped clients</span></a>.</p>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">Cake\Http\Client</span></code> supports a few different authentication systems.  Different
authentication strategies can be added by developers. Auth strategies are called
before the request is sent, and allow headers to be added to the request
context.</p>
<div class="section" id="using-basic-authentication">
<h3>Using Basic Authentication<a class="headerlink" href="#using-basic-authentication" title="Permalink to this headline">¶</a></h3>
<p>An example of basic authentication:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/profile/1&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span>
  <span class="s1">&#39;auth&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mark&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>By default <code class="docutils literal"><span class="pre">Cake\Http\Client</span></code> will use basic authentication if there is no
<code class="docutils literal"><span class="pre">'type'</span></code> key in the auth option.</p>
</div>
<div class="section" id="using-digest-authentication">
<h3>Using Digest Authentication<a class="headerlink" href="#using-digest-authentication" title="Permalink to this headline">¶</a></h3>
<p>An example of basic authentication:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/profile/1&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span>
  <span class="s1">&#39;auth&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;digest&#39;</span><span class="p">,</span>
    <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mark&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span><span class="p">,</span>
    <span class="s1">&#39;realm&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;myrealm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nonce&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;onetimevalue&#39;</span><span class="p">,</span>
    <span class="s1">&#39;qop&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;opaque&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;someval&#39;</span>
  <span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>By setting the &#8216;type&#8217; key to &#8216;digest&#8217;, you tell the authentication subsystem to
use digest authentication.</p>
</div>
<div class="section" id="oauth-1-authentication">
<h3>OAuth 1 Authentication<a class="headerlink" href="#oauth-1-authentication" title="Permalink to this headline">¶</a></h3>
<p>Many modern web-services require OAuth authentication to access their API&#8217;s.
The included OAuth authentication assumes that you already have your consumer
key and consumer secret:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/profile/1&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span>
  <span class="s1">&#39;auth&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;oauth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;consumerKey&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bigkey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;consumerSecret&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span><span class="p">,</span>
    <span class="s1">&#39;token&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tokenSecret&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="s1">&#39;realm&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;tickets&#39;</span><span class="p">,</span>
  <span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="oauth-2-authentication">
<h3>OAuth 2 Authentication<a class="headerlink" href="#oauth-2-authentication" title="Permalink to this headline">¶</a></h3>
<p>Because OAuth2 is often a single header, there is not a specialized
authentication adapter. Instead you can create a client with the access token:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">([</span>
    <span class="s1">&#39;headers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;Authorization&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bearer &#39;</span> <span class="o">.</span> <span class="nv">$accessToken</span><span class="p">]</span>
<span class="p">]);</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;https://example.com/api/profile/1&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="proxy-authentication">
<h3>Proxy Authentication<a class="headerlink" href="#proxy-authentication" title="Permalink to this headline">¶</a></h3>
<p>Some proxies require authentication to use them. Generally this authentication
is Basic, but it can be implemented by any authentication adapter.  By default
Http\Client will assume Basic authentication, unless the type key is set:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/test.php&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span>
  <span class="s1">&#39;proxy&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mark&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;testing&#39;</span><span class="p">,</span>
    <span class="s1">&#39;proxy&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;127.0.0.1:8080&#39;</span><span class="p">,</span>
  <span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The second proxy parameter must be a string with an IP or a domain without
protocol. The username and password information will be passed through the
request headers, while the proxy string will be passed through
<a class="reference external" href="http://php.net/manual/en/function.stream-context-create.php">stream_context_create()</a>.</p>
</div>
</div>
<div class="section" id="creating-scoped-clients">
<span id="http-client-scoped-client"></span><h2>Creating Scoped Clients<a class="headerlink" href="#creating-scoped-clients" title="Permalink to this headline">¶</a></h2>
<p>Having to re-type the domain name, authentication and proxy settings can become
tedious &amp; error prone.  To reduce the chance for mistake and relieve some of the
tedium, you can create scoped clients:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Create a scoped client.</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">([</span>
  <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;api.example.com&#39;</span><span class="p">,</span>
  <span class="s1">&#39;scheme&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span>
  <span class="s1">&#39;auth&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mark&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;testing&#39;</span><span class="p">]</span>
<span class="p">]);</span>

<span class="c1">// Do a request to api.example.com</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/test.php&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The following information can be used when creating a scoped client:</p>
<ul class="simple">
<li>host</li>
<li>scheme</li>
<li>proxy</li>
<li>auth</li>
<li>port</li>
<li>cookies</li>
<li>timeout</li>
<li>ssl_verify_peer</li>
<li>ssl_verify_depth</li>
<li>ssl_verify_host</li>
</ul>
<p>Any of these options can be overridden by specifying them when doing requests.
host, scheme, proxy, port are overridden in the request URL:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Using the scoped client we created earlier.</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://foo.com/test.php&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The above will replace the domain, scheme, and port.  However, this request will
continue using all the other options defined when the scoped client was created.
See <a class="reference internal" href="#http-client-request-options"><span class="std std-ref">Request Method Options</span></a> for more information on the options
supported.</p>
</div>
<div class="section" id="setting-and-managing-cookies">
<h2>Setting and Managing Cookies<a class="headerlink" href="#setting-and-managing-cookies" title="Permalink to this headline">¶</a></h2>
<p>Http\Client can also accept cookies when making requests. In addition to
accepting cookies, it will also automatically store valid cookies set in
responses. Any response with cookies, will have them stored in the originating
instance of Http\Client. The cookies stored in a Client instance are
automatically included in future requests to domain + path combinations that
match:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">([</span>
    <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cakephp.org&#39;</span>
<span class="p">]);</span>

<span class="c1">// Do a request that sets some cookies</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// Cookies from the first request will be included</span>
<span class="c1">// by default.</span>
<span class="nv">$response2</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/changelogs&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can always override the auto-included cookies by setting them in the
request&#8217;s <code class="docutils literal"><span class="pre">$options</span></code> parameters:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Replace a stored cookie with a custom value.</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/changelogs&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span>
    <span class="s1">&#39;cookies&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;sessionid&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;123abc&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>You can add cookie objects to the client after creating it using the <code class="docutils literal"><span class="pre">addCookie()</span></code>
method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\Http\Cookie\Cookie</span><span class="p">;</span>

<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">([</span>
    <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cakephp.org&#39;</span>
<span class="p">]);</span>
<span class="nv">$http</span><span class="o">-&gt;</span><span class="na">addCookie</span><span class="p">(</span><span class="k">new</span> <span class="nx">Cookie</span><span class="p">(</span><span class="s1">&#39;session&#39;</span><span class="p">,</span> <span class="s1">&#39;abc123&#39;</span><span class="p">));</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.5.0: </span><code class="docutils literal"><span class="pre">addCookie()</span></code> was added in 3.5.0</p>
</div>
</div>
<div class="section" id="namespace-Cake\Http\Client">
<span id="response-objects"></span><span id="httpclient-response-objects"></span><h2>Response Objects<a class="headerlink" href="#namespace-Cake\Http\Client" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Cake\Http\Client\Response">
<em class="property">class </em><code class="descclassname">Cake\Http\Client\</code><code class="descname">Response</code><a class="headerlink" href="#Cake\Http\Client\Response" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Response objects have a number of methods for inspecting the response data.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.3.0: </span>As of 3.3.0 <code class="docutils literal"><span class="pre">Cake\Http\Client\Response</span></code> implements the <a class="reference external" href="http://www.php-fig.org/psr/psr-7/#3-3-psr-http-message-responseinterface">PSR-7
ResponseInterface</a>.</p>
</div>
<div class="section" id="reading-response-bodies">
<h3>Reading Response Bodies<a class="headerlink" href="#reading-response-bodies" title="Permalink to this headline">¶</a></h3>
<p>You read the entire response body as a string:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Read the entire response as a string.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">();</span>

<span class="c1">// As a property</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also access the stream object for the response and use its methods:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get a Psr\Http\Message\StreamInterface containing the response body</span>
<span class="nv">$stream</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">();</span>

<span class="c1">// Read a stream 100 bytes at a time.</span>
<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nv">$stream</span><span class="o">-&gt;</span><span class="na">eof</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$stream</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-json-and-xml-response-bodies">
<span id="http-client-xml-json"></span><h3>Reading JSON and XML Response Bodies<a class="headerlink" href="#reading-json-and-xml-response-bodies" title="Permalink to this headline">¶</a></h3>
<p>Since JSON and XML responses are commonly used, response objects provide easy to
use accessors to read decoded data. JSON data is decoded into an array, while
XML data is decoded into a <code class="docutils literal"><span class="pre">SimpleXMLElement</span></code> tree:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get some XML</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/test.xml&#39;</span><span class="p">);</span>
<span class="nv">$xml</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">xml</span><span class="p">;</span>

<span class="c1">// Get some JSON</span>
<span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http://example.com/test.json&#39;</span><span class="p">);</span>
<span class="nv">$json</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">json</span><span class="p">;</span>
</pre></div>
</div>
<p>The decoded response data is stored in the response object, so accessing it
multiple times has no additional cost.</p>
</div>
<div class="section" id="accessing-response-headers">
<h3>Accessing Response Headers<a class="headerlink" href="#accessing-response-headers" title="Permalink to this headline">¶</a></h3>
<p>You can access headers through a few different methods. Header names are always
treated as case-insensitive values when accessing them through methods:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get all the headers as an associative array.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getHeaders</span><span class="p">();</span>

<span class="c1">// Get a single header as an array.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getHeader</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">);</span>

<span class="c1">// Get a header as a string</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getHeaderLine</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">);</span>

<span class="c1">// Get the response encoding</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getEncoding</span><span class="p">();</span>

<span class="c1">// Get an array of key=&gt;value for all headers</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-cookie-data">
<h3>Accessing Cookie Data<a class="headerlink" href="#accessing-cookie-data" title="Permalink to this headline">¶</a></h3>
<p>You can read cookies with a few different methods depending on how much
data you need about the cookies:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get all cookies (full data)</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getCookies</span><span class="p">();</span>

<span class="c1">// Get a single cookie&#39;s value.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getCookie</span><span class="p">(</span><span class="s1">&#39;session_id&#39;</span><span class="p">);</span>

<span class="c1">// Get a the complete data for a single cookie</span>
<span class="c1">// includes value, expires, path, httponly, secure keys.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getCookieData</span><span class="p">(</span><span class="s1">&#39;session_id&#39;</span><span class="p">);</span>

<span class="c1">// Access the complete data for all cookies.</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">cookies</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-the-status-code">
<h3>Checking the Status Code<a class="headerlink" href="#checking-the-status-code" title="Permalink to this headline">¶</a></h3>
<p>Response objects provide a few methods for checking status codes:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Was the response a 20x</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">isOk</span><span class="p">();</span>

<span class="c1">// Was the response a 30x</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">isRedirect</span><span class="p">();</span>

<span class="c1">// Get the status code</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getStatusCode</span><span class="p">();</span>

<span class="c1">// __get() helper</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">code</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>


            </div>
        </div>

        
        <div class="col-md-3 col-md-pull-9 hidden-xs hidden-sm" lang="en">
            <aside class="sidebar">
                <div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<p class="caption"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">CakePHP at a Glance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/3-x-migration-guide.html">3.x Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/request-response.html">Request &amp; Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orm.html">Database Access &amp; ORM</a></li>
</ul>
<p class="caption"><span class="caption-text">Using CakePHP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../controllers/components/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bake.html">Bake Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console-and-shells.html">Console Tools, Shells &amp; Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/errors.html">Error &amp; Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events System</a></li>
<li class="toctree-l1"><a class="reference internal" href="internationalization-and-localization.html">Internationalization &amp; Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="form.html">Modelless Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/components/pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/rest.html">REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/sessions.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility Classes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="app.html">App Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-folder.html">Folder &amp; File</a></li>
<li class="toctree-l1"><a class="reference internal" href="hash.html">Hash</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Http Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="inflector.html">Inflector</a></li>
<li class="toctree-l1"><a class="reference internal" href="number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry-objects.html">Registry Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="time.html">Date &amp; Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="xml.html">Xml</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chronos.html">Chronos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug-kit.html">Debug Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade-tool.html">Upgrade Tool</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global-constants-and-functions.html">Constants &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices.html">Appendices</a></li>
</ul>

</div>

                </div>
            </aside>
            <aside class="sidebar">
                <div class="mb30 row">
                </div>
            </aside>
        </div>
    </div>
</div>

<section id="socials" class="back-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-5  social text-center">
                <div class="col-sm-3 col-xs-3">
                    <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                          var js, fjs = d.getElementsByTagName(s)[0];
                          if (d.getElementById(id)) return;
                          js = d.createElement(s); js.id = id;
                          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
                          fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));
                        </script>
                        <div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-7 social-footer text-center ">
                <a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
                <a href="https://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
                <a href="https://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
                <a href="https://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
                <a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
                <a href="https://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
                <a href="https://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
                <a href="https://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
            </div>
        </div>
    </div>
</section>

<footer id="footer" class="footer-wrapper">
    <div class="container">

        <div class="row col-p30">
            <div class="col-sm-12 col-md-3">
                <div class="footer-widget t-footer">
                    <div class="col-md-12">
                        <a href="https://www.openhub.net/p/cakephp">
                            <img src="../_static/open-hub.png">
                        </a>
                        <div class="mt10">
                            <a href="https://www.rackspace.com/">
                                <img src="../_static/rackspace.png">
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12 col-md-9">
                <div class="col-md-3 col-sm-6 business-solution">
                    <ul class="footer-menu">
                        <li class="menu-title">
    <a href="https://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
    <a href="https://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center mt30">
                <p class="copyright">
                            &copy; Copyright 2017, Cake Software Foundation, Inc.
                        Last updated on Aug 30, 2017.
                        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
                </p>
            </div>
        </div>
    </div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-743287-3']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
  </body>
</html>