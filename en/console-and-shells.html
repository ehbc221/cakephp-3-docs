

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Shells, Tasks &amp; Console Tools" lang="en" name="title" />
<meta content="shell scripts,system shell,application classes,background tasks,line script,cron job,request response,system path,acl,new projects,shells,specifics,parameters,i18n,cakephp,directory,maintenance,ideal,applications,mvc" lang="en" name="keywords" />

    <title>Console Tools, Shells &amp; Tasks - 3.x</title>
    <link href="_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="_static/app.js"></script>

    <link rel="alternate" hreflang="pt_BR" href="../pt/console-and-shells.html" /><link rel="alternate" hreflang="es" href="../es/console-and-shells.html" /><link rel="alternate" hreflang="ja" href="../ja/console-and-shells.html" /><link rel="alternate" hreflang="fr" href="../fr/console-and-shells.html" /><link rel="alternate" hreflang="zh" href="../zh/console-and-shells.html" /><link rel="alternate" hreflang="tr" href="../tr/console-and-shells.html" /><link rel="alternate" hreflang="ru" href="../ru/console-and-shells.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 3.5 documentation" href="_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 3.5 documentation" href="index.html" />
    <link rel="next" title="Shell Helpers" href="console-and-shells/helpers.html" />
    <link rel="prev" title="Caching" href="core-libraries/caching.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
    
    <header class="nav-down">
        <div class="container-fluid hidden-xs hidden-sm">
            <div class="row">
                <div class="col-sm-3 col-md-3">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-9 col-md-9">
                    <nav class="navbar-right">
                        <ul class="menu">
                            <li class="first">
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
                                <ul class="submenu">
                                    
<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                                </ul>
                            </li>

                            <li><a href="https://cakephp.org/business-solutions">Business Solutions</a></li>
                            <li><a href="https://cakephp.org/writers">Get Paid To Write</a></li>
                            <li><a href="https://cakephp.org/pages/team">Team</a></li>

                            <li>
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
                                <div class="megamenu full">
                                    <div class="row">
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

        
        <div class="container-fluid hidden-md hidden-lg">
            <div class="row">
                <div class="col-sm-6 col-xs-6">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-6 col-xs-6">
                    <div class="navbar-right">
                        <button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
                            <i class="fa fa-bars toggle-modal"></i>
                        </button>
                    </div>
                    <div id="wrap">
                        <form class="search" action="search.html" method="get">
                            <input name="q" type="search" placeholder="What are you looking for?">
                            <input id="search_submit" value="Search" type="submit">
                        </form>
                    </div>
                </div>
            </div>
        </div>

        
        <section id="nav-cook" class="hidden-xs hidden-sm">
            <div class="container-fluid ">
                <div class="row ">
                    <div class="col-md-12 back-book">
                        <div class="col-md-5 text-center t-cook-nav p0 hidden-sm hidden-xs">
                            <h2>
                                <a href="contents.html">
                                    <span class="glyph_range icon-submenu icon-submenu-cook">B</span>
                                    CakePHP 3.5 Red Velvet <strong>Cookbook</strong>
                                </a>
                            </h2>
                        </div>

                        <div class="col-md-4 hidden-sm">
                            <form class="search" action="search.html" method="get">
                                <input type="hidden" name="check_keywords" value="yes" />
                                <input type="hidden" name="area" value="default" />

                                <div class="col-md-10 p0">
                                    <input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
                                </div>
                                <div class="col-md-2 p0 search-cook">
                                    <button type="submit">
                                        <span class="glyph_range icon-submenu icon-submenu-cook">A</span>
                                    </button>
                                </div>
                            </form>
                        </div>

                        
                        <div class="col-md-3">
                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Language:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
                                                    role="button" aria-haspopup="true" aria-expanded="false" href="#">
                                                        en
                                                        <i class="fa fa-menu-en fa-chevron-down"></i>
                                                    </a>
                                            <ul class="dropdown-menu">
                                            
                                                <li></li>
                                            
                                                <li><a href="../pt/console-and-shells.html">pt</a></li>
                                            
                                                <li><a href="../es/console-and-shells.html">es</a></li>
                                            
                                                <li><a href="../ja/console-and-shells.html">ja</a></li>
                                            
                                                <li><a href="../fr/console-and-shells.html">fr</a></li>
                                            
                                                <li><a href="../zh/console-and-shells.html">zh</a></li>
                                            
                                                <li><a href="../tr/console-and-shells.html">tr</a></li>
                                            
                                                <li><a href="../ru/console-and-shells.html">ru</a></li>
                                            
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Version:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">3.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="https://book.cakephp.org/3.0/en">3.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/2.0/en">2.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.3/en/">1.3 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.2/en/">1.2 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.1/en">1.1 Book</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </section>
    </header>

    
    <section class="nav-btn visible-sm visible-xs">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
                </div>

                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
                </div>
            </div>
        </div>
    </section>

    
    <div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title-cookbook" id="modal-header"></h4>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>

<div class="container page-container "><div id="improve-slideout">
        <i class="fa fa-pencil icon-improve"></i>
        <a href="https://github.com/cakephp/docs/edit/3.0/en/console-and-shells.rst" target="_blank">
            <div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
        </a>
    </div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

    
    <div class="row">
        <div class="col-sm-12 col-md-9 col-md-push-3"><div class="page-contents col-sm-5">
                <h3>Page Contents</h3>
                <ul>
<li><a class="reference internal" href="#">Console Tools, Shells &amp; Tasks</a><ul>
<li><a class="reference internal" href="#the-cakephp-console">The CakePHP Console</a></li>
<li><a class="reference internal" href="#creating-a-shell">Creating a Shell</a></li>
<li><a class="reference internal" href="#shell-tasks">Shell Tasks</a><ul>
<li><a class="reference internal" href="#loading-tasks-on-the-fly-with-taskregistry">Loading Tasks On The Fly with TaskRegistry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-models-in-your-shells">Using Models in Your Shells</a></li>
<li><a class="reference internal" href="#shell-helpers">Shell Helpers</a></li>
<li><a class="reference internal" href="#invoking-other-shells-from-your-shell">Invoking Other Shells from Your Shell</a><ul>
<li><a class="reference internal" href="#passing-extra-parameters-to-the-dispatched-shell">Passing extra parameters to the dispatched Shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-user-input">Getting User Input</a></li>
<li><a class="reference internal" href="#creating-files">Creating Files</a></li>
<li><a class="reference internal" href="#console-output">Console Output</a><ul>
<li><a class="reference internal" href="#console-output-levels">Console Output Levels</a></li>
<li><a class="reference internal" href="#styling-output">Styling Output</a></li>
<li><a class="reference internal" href="#turning-off-colouring">Turning Off Colouring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stopping-shell-execution">Stopping Shell Execution</a><ul>
<li><a class="reference internal" href="#status-and-error-codes">Status and Error Codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hook-methods">Hook Methods</a></li>
<li><a class="reference internal" href="#configuring-options-and-generating-help">Configuring Options and Generating Help</a><ul>
<li><a class="reference internal" href="#configuring-an-option-parser-with-the-fluent-interface">Configuring an Option Parser with the Fluent Interface</a><ul>
<li><a class="reference internal" href="#set-the-description">Set the Description</a></li>
<li><a class="reference internal" href="#set-a-help-alias">Set a help alias</a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-the-epilog">Set the Epilog</a></li>
<li><a class="reference internal" href="#adding-arguments">Adding Arguments</a></li>
<li><a class="reference internal" href="#validating-arguments">Validating Arguments</a></li>
<li><a class="reference internal" href="#adding-options">Adding Options</a></li>
<li><a class="reference internal" href="#validating-options">Validating Options</a></li>
<li><a class="reference internal" href="#using-boolean-options">Using Boolean Options</a></li>
<li><a class="reference internal" href="#adding-subcommands">Adding Subcommands</a></li>
<li><a class="reference internal" href="#building-a-consoleoptionparser-from-an-array">Building a ConsoleOptionParser from an Array</a></li>
<li><a class="reference internal" href="#merging-consoleoptionparsers">Merging ConsoleOptionParsers</a></li>
<li><a class="reference internal" href="#getting-help-from-shells">Getting Help from Shells</a></li>
<li><a class="reference internal" href="#getting-help-as-xml">Getting Help as XML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#renaming-commands">Renaming Commands</a></li>
<li><a class="reference internal" href="#routing-in-shells-cli">Routing in Shells / CLI</a></li>
<li><a class="reference internal" href="#more-topics">More Topics</a></li>
</ul>
</li>
</ul>

            </div><div class="document-body">
            
  <div class="section" id="namespace-Cake\Console">
<span id="console-tools-shells-tasks"></span><h1>Console Tools, Shells &amp; Tasks<a class="headerlink" href="#namespace-Cake\Console" title="Permalink to this headline">¶</a></h1>
<p>CakePHP features not only a web framework but also a console framework for
creating console applications. Console applications are ideal for handling a
variety of background tasks such as maintenance, and completing work outside of
the request-response cycle. CakePHP console applications allow you to reuse your
application classes from the command line.</p>
<p>CakePHP comes with a number of console applications out of the box. Some of
these applications are used in concert with other CakePHP features (like i18n),
and others are for general use to get you working faster.</p>
<div class="section" id="the-cakephp-console">
<h2>The CakePHP Console<a class="headerlink" href="#the-cakephp-console" title="Permalink to this headline">¶</a></h2>
<p>This section provides an introduction into CakePHP at the command-line. Console
tools are ideal for use in cron jobs, or command line based utilities that don&#8217;t
need to be accessible from a web browser.</p>
<p>PHP provides a CLI client that makes interfacing with your file system and
applications much smoother. The CakePHP console provides a framework for
creating shell scripts. The Console uses a dispatcher-type setup to load a shell
or task, and provide its parameters.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A command-line (CLI) build of PHP must be available on the system
if you plan to use the Console.</p>
</div>
<p>Before we get into specifics, let&#8217;s make sure you can run the CakePHP console.
First, you&#8217;ll need to bring up a system shell. The examples shown in this
section will be in bash, but the CakePHP Console is Windows-compatible as well.
This example assumes that the user is currently logged into a bash prompt and is
currently at the root of a CakePHP application.</p>
<p>A CakePHP application contains <strong>src/Shell</strong> and <strong>src/Shell/Task</strong> directories
that contain all of its shells and tasks. It also comes with an executable in
the <strong>bin</strong> directory:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">cd</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">app</span>
<span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For Windows, the command needs to be <code class="docutils literal"><span class="pre">bin\cake</span></code> (note the backslash).</p>
</div>
<p>Running the Console with no arguments produces this help message:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">CakePHP</span> <span class="nx">v3</span><span class="o">.</span><span class="mf">5.0</span> <span class="nx">Console</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">App</span> <span class="o">:</span> <span class="nx">App</span>
<span class="nx">Path</span><span class="o">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">markstory</span><span class="o">/</span><span class="nx">Sites</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">Current</span> <span class="nx">Paths</span><span class="o">:</span>

 <span class="o">-</span><span class="nx">app</span><span class="o">:</span> <span class="nx">src</span>
 <span class="o">-</span><span class="nx">root</span><span class="o">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">markstory</span><span class="o">/</span><span class="nx">Sites</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">-</span><span class="nx">app</span>
 <span class="o">-</span><span class="nx">core</span><span class="o">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">markstory</span><span class="o">/</span><span class="nx">Sites</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">-</span><span class="nx">app</span><span class="o">/</span><span class="nx">vendor</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">cakephp</span>

<span class="nx">Changing</span> <span class="nx">Paths</span><span class="o">:</span>

<span class="nx">Your</span> <span class="nx">working</span> <span class="nx">path</span> <span class="nx">should</span> <span class="nx">be</span> <span class="nx">the</span> <span class="nx">same</span> <span class="k">as</span> <span class="nx">your</span> <span class="nx">application</span> <span class="nx">path</span><span class="o">.</span> <span class="nx">To</span> <span class="nx">change</span> <span class="nx">your</span> <span class="nx">path</span> <span class="k">use</span> <span class="nx">the</span> <span class="s1">&#39;-app&#39;</span> <span class="nx">param</span><span class="o">.</span>
<span class="nx">Example</span><span class="o">:</span> <span class="o">-</span><span class="nx">app</span> <span class="nx">relative</span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">myapp</span> <span class="k">or</span> <span class="o">-</span><span class="nx">app</span> <span class="o">/</span><span class="nx">absolute</span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">myapp</span>

<span class="nx">Available</span> <span class="nx">Shells</span><span class="o">:</span>

<span class="o">-</span> <span class="nx">version</span>
<span class="o">-</span> <span class="nx">help</span>
<span class="o">-</span> <span class="nx">cache</span>
<span class="o">-</span> <span class="nx">completion</span>
<span class="o">-</span> <span class="nx">i18n</span>
<span class="o">-</span> <span class="nx">orm_cache</span>
<span class="o">-</span> <span class="nx">plugin</span>
<span class="o">-</span> <span class="nx">routes</span>
<span class="o">-</span> <span class="nx">server</span>
<span class="o">-</span> <span class="nx">bug</span>
<span class="o">-</span> <span class="nx">console</span>
<span class="o">-</span> <span class="nx">event</span>
<span class="o">-</span> <span class="nx">orm</span>
<span class="o">-</span> <span class="nx">bake</span>
<span class="o">-</span> <span class="nx">bake</span><span class="o">.</span><span class="nx">bake</span>
<span class="o">-</span> <span class="nx">migrations</span>
<span class="o">-</span> <span class="nx">migrations</span><span class="o">.</span><span class="nx">migrations</span>

<span class="nx">To</span> <span class="nx">run</span> <span class="nx">a</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">type</span> <span class="sb">`cake shell_name [args|options]`</span>
<span class="nx">To</span> <span class="nx">get</span> <span class="nx">help</span> <span class="nx">on</span> <span class="nx">a</span> <span class="nx">specific</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">type</span> <span class="sb">`cake shell_name --help`</span>
</pre></div>
</div>
<p>The first information printed relates to paths. This is helpful if you&#8217;re
running the console from different parts of the filesystem.</p>
<p>You could then run the any of the listed shells by using its name:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1"># run server shell</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">server</span>

<span class="c1"># run migrations shell</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">migrations</span> <span class="o">-</span><span class="nx">h</span>

<span class="c1"># run bake (with plugin prefix)</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">bake</span><span class="o">.</span><span class="nx">bake</span> <span class="o">-</span><span class="nx">h</span>
</pre></div>
</div>
<p>Plugin shells can be invoked without a plugin prefix if the shell&#8217;s name does
not overlap with an application or framework shell. In the case that two plugins
provide a shell with the same name, the first loaded plugin will get the short
alias. You can always use the <code class="docutils literal"><span class="pre">plugin.shell</span></code> format to unambiguously reference
a shell.</p>
<dl class="class">
<dt id="Cake\Console\Shell">
<em class="property">class </em><code class="descclassname">Cake\Console\</code><code class="descname">Shell</code><a class="headerlink" href="#Cake\Console\Shell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="creating-a-shell">
<h2>Creating a Shell<a class="headerlink" href="#creating-a-shell" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s create a shell for use in the Console. For this example, we&#8217;ll create a
simple Hello world shell. In your application&#8217;s <strong>src/Shell</strong> directory create
<strong>HelloShell.php</strong>. Put the following code inside it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Shell</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Console\Shell</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hello world.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The conventions for shell classes are that the class name should match the file
name, with the suffix of Shell. In our shell we created a <code class="docutils literal"><span class="pre">main()</span></code> method.
This method is called when a shell is called with no additional commands. We&#8217;ll
add some more commands in a bit, but for now let&#8217;s just run our shell. From your
application directory, run:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">hello</span>
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">Hello</span> <span class="nx">world</span><span class="o">.</span>
</pre></div>
</div>
<p>As mentioned before, the <code class="docutils literal"><span class="pre">main()</span></code> method in shells is a special method called
whenever there are no other commands or arguments given to a shell. Since our
main method wasn&#8217;t very interesting let&#8217;s add another command that does
something:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Shell</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Console\Shell</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hello world.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">heyThere</span><span class="p">(</span><span class="nv">$name</span> <span class="o">=</span> <span class="s1">&#39;Anonymous&#39;</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hey there &#39;</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After saving this file, you should be able to run the following command and see
your name printed out:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">hello</span> <span class="nx">hey_there</span> <span class="nx">your</span><span class="o">-</span><span class="nx">name</span>
</pre></div>
</div>
<p>Any public method not prefixed by an <code class="docutils literal"><span class="pre">_</span></code> is allowed to be called from the
command line. As you can see, methods invoked from the command line are
transformed from the underscored shell argument to the correct camel-cased
method name in the class.</p>
<p>In our <code class="docutils literal"><span class="pre">heyThere()</span></code> method we can see that positional arguments are provided
to our <code class="docutils literal"><span class="pre">heyThere()</span></code> function. Positional arguments are also available in the
<code class="docutils literal"><span class="pre">args</span></code> property.
You can access switches or options on shell applications, which are available at
<code class="docutils literal"><span class="pre">$this-&gt;params</span></code>, but we&#8217;ll cover that in a bit.</p>
<p>When using a <code class="docutils literal"><span class="pre">main()</span></code> method you won&#8217;t be able to use the positional
arguments. This is because the first positional argument or option is
interpreted as the command name. If you want to use arguments, you should use
method names other than <code class="docutils literal"><span class="pre">main</span></code>.</p>
</div>
<div class="section" id="shell-tasks">
<h2>Shell Tasks<a class="headerlink" href="#shell-tasks" title="Permalink to this headline">¶</a></h2>
<p>There will be times when building more advanced console applications, you&#8217;ll
want to compose functionality into re-usable classes that can be shared across
many shells. Tasks allow you to extract commands into classes. For example the
<code class="docutils literal"><span class="pre">bake</span></code> command is made almost entirely of tasks. You define a tasks for a
shell using the <code class="docutils literal"><span class="pre">$tasks</span></code> property:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UserShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tasks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Template&#39;</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can use tasks from plugins using the standard <a class="reference internal" href="appendices/glossary.html#term-plugin-syntax"><span class="xref std std-term">plugin syntax</span></a>.
Tasks are stored in <code class="docutils literal"><span class="pre">Shell/Task/</span></code> in files named after their classes. So if
we were to create a new &#8216;FileGenerator&#8217; task, you would create
<strong>src/Shell/Task/FileGeneratorTask.php</strong>.</p>
<p>Each task must at least implement a <code class="docutils literal"><span class="pre">main()</span></code> method. The ShellDispatcher,
will call this method when the task is invoked. A task class looks like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Shell\Task</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Console\Shell</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">FileGeneratorTask</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A shell can also access its tasks as properties, which makes tasks great for
making re-usable chunks of functionality similar to
<a class="reference internal" href="controllers/components.html"><span class="doc">Components</span></a>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Found in src/Shell/SeaShell.php</span>
<span class="k">class</span> <span class="nc">SeaShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="c1">// Found in src/Shell/Task/SoundTask.php</span>
    <span class="k">public</span> <span class="nv">$tasks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sound&#39;</span><span class="p">];</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Sound</span><span class="o">-&gt;</span><span class="na">main</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also access tasks directly from the command line:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">cake</span> <span class="nx">sea</span> <span class="nx">sound</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to access tasks directly from the command line, the task
<strong>must</strong> be included in the shell class&#8217; $tasks property.</p>
</div>
<p>Also, the task name must be added as a sub-command to the Shell&#8217;s OptionParser:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getOptionParser</span><span class="p">();</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addSubcommand</span><span class="p">(</span><span class="s1">&#39;sound&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="c1">// Provide help text for the command list</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Execute The Sound Task.&#39;</span><span class="p">,</span>
        <span class="c1">// Link the option parsers together.</span>
        <span class="s1">&#39;parser&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Sound</span><span class="o">-&gt;</span><span class="na">getOptionParser</span><span class="p">(),</span>
    <span class="p">]);</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="loading-tasks-on-the-fly-with-taskregistry">
<h3>Loading Tasks On The Fly with TaskRegistry<a class="headerlink" href="#loading-tasks-on-the-fly-with-taskregistry" title="Permalink to this headline">¶</a></h3>
<p>You can load tasks on the fly using the Task registry object. You can load tasks
that were not declared in $tasks this way:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$project</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tasks</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;Project&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Would load and return a ProjectTask instance. You can load tasks from plugins
using:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$progressBar</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tasks</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;ProgressBar.ProgressBar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-models-in-your-shells">
<h2>Using Models in Your Shells<a class="headerlink" href="#using-models-in-your-shells" title="Permalink to this headline">¶</a></h2>
<p>You&#8217;ll often need access to your application&#8217;s business logic in shell
utilities; CakePHP makes that super easy. You can load models in shells, just as
you would in a controller using <code class="docutils literal"><span class="pre">loadModel()</span></code>. The loaded models are set as
properties attached to your shell:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Shell</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Console\Shell</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">UserShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">initialize</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadModel</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
            <span class="c1">// Use error() before CakePHP 3.2</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">abort</span><span class="p">(</span><span class="s1">&#39;Please enter a username.&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Users</span><span class="o">-&gt;</span><span class="na">findByUsername</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="k">true</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above shell, will fetch a user by username and display the information
stored in the database.</p>
</div>
<div class="section" id="shell-helpers">
<h2>Shell Helpers<a class="headerlink" href="#shell-helpers" title="Permalink to this headline">¶</a></h2>
<p>If you have complex output generation logic, you can use
<a class="reference internal" href="console-and-shells/helpers.html"><span class="doc">Shell Helpers</span></a> to encapsulate this logic in a re-usable way.</p>
</div>
<div class="section" id="invoking-other-shells-from-your-shell">
<span id="id1"></span><h2>Invoking Other Shells from Your Shell<a class="headerlink" href="#invoking-other-shells-from-your-shell" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\Console\Shell::dispatchShell">
<code class="descclassname">Cake\Console\Shell::</code><code class="descname">dispatchShell</code><span class="sig-paren">(</span><em>$args</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\Shell::dispatchShell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>There are still many cases where you will want to invoke one shell from another though.
<code class="docutils literal"><span class="pre">Shell::dispatchShell()</span></code> gives you the ability to call other shells by providing the
<code class="docutils literal"><span class="pre">argv</span></code> for the sub shell. You can provide arguments and options either
as var args or as a string:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// As a string</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">(</span><span class="s1">&#39;schema create Blog --plugin Blog&#39;</span><span class="p">);</span>

<span class="c1">// As an array</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">,</span> <span class="s1">&#39;--plugin&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The above shows how you can call the schema shell to create the schema for a plugin
from inside your plugin&#8217;s shell.</p>
<div class="section" id="passing-extra-parameters-to-the-dispatched-shell">
<h3>Passing extra parameters to the dispatched Shell<a class="headerlink" href="#passing-extra-parameters-to-the-dispatched-shell" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
<p>It can sometimes be useful to pass on extra parameters (that are not shell arguments)
to the dispatched Shell. In order to do this, you can now pass an array to
<code class="docutils literal"><span class="pre">dispatchShell()</span></code>. The array is expected to have a <code class="docutils literal"><span class="pre">command</span></code> key as well
as an <code class="docutils literal"><span class="pre">extra</span></code> key:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Using a command string</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">([</span>
   <span class="s1">&#39;command&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;schema create Blog --plugin Blog&#39;</span><span class="p">,</span>
   <span class="s1">&#39;extra&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar&#39;</span>
    <span class="p">]</span>
<span class="p">]);</span>

<span class="c1">// Using a command array</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">([</span>
   <span class="s1">&#39;command&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">,</span> <span class="s1">&#39;--plugin&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">],</span>
   <span class="s1">&#39;extra&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar&#39;</span>
    <span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>Parameters passed through <code class="docutils literal"><span class="pre">extra</span></code> will be merged in the <code class="docutils literal"><span class="pre">Shell::$params</span></code>
property and are accessible with the <code class="docutils literal"><span class="pre">Shell::param()</span></code> method.
By default, a <code class="docutils literal"><span class="pre">requested</span></code> extra param is automatically added when a Shell
is dispatched using <code class="docutils literal"><span class="pre">dispatchShell()</span></code>. This <code class="docutils literal"><span class="pre">requested</span></code> parameter prevents
the CakePHP console welcome message from being displayed on dispatched shells.</p>
</div>
</div>
<div class="section" id="getting-user-input">
<h2>Getting User Input<a class="headerlink" href="#getting-user-input" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\Console\Shell::in">
<code class="descclassname">Cake\Console\Shell::</code><code class="descname">in</code><span class="sig-paren">(</span><em>$question</em>, <em>$choices = null</em>, <em>$default = null</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\Shell::in" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>When building interactive console applications you&#8217;ll need to get user input.
CakePHP provides an easy way to do this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get arbitrary text from the user.</span>
<span class="nv">$color</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">in</span><span class="p">(</span><span class="s1">&#39;What color do you like?&#39;</span><span class="p">);</span>

<span class="c1">// Get a choice from the user.</span>
<span class="nv">$selection</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">in</span><span class="p">(</span><span class="s1">&#39;Red or Green?&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span> <span class="s1">&#39;R&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Selection validation is case-insensitive.</p>
</div>
<div class="section" id="creating-files">
<h2>Creating Files<a class="headerlink" href="#creating-files" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\Console\Shell::createFile">
<code class="descclassname">Cake\Console\Shell::</code><code class="descname">createFile</code><span class="sig-paren">(</span><em>$path</em>, <em>$contents</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\Shell::createFile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Many Shell applications help automate development or deployment tasks. Creating
files is often important in these use cases. CakePHP provides an easy way to
create a file at a given path:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createFile</span><span class="p">(</span><span class="s1">&#39;bower.json&#39;</span><span class="p">,</span> <span class="nv">$stuff</span><span class="p">);</span>
</pre></div>
</div>
<p>If the Shell is interactive, a warning will be generated, and the user asked if
they want to overwrite the file if it already exists.  If the shell&#8217;s
interactive property is <code class="docutils literal"><span class="pre">false</span></code>, no question will be asked and the file will
simply be overwritten.</p>
</div>
<div class="section" id="console-output">
<h2>Console Output<a class="headerlink" href="#console-output" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">Shell</span></code> class provides a few methods for outputting content:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Write to stdout</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Normal message&#39;</span><span class="p">);</span>

<span class="c1">// Write to stderr</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">err</span><span class="p">(</span><span class="s1">&#39;Error message&#39;</span><span class="p">);</span>

<span class="c1">// Write to stderr and raise a stop exception</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">abort</span><span class="p">(</span><span class="s1">&#39;Fatal error&#39;</span><span class="p">);</span>

<span class="c1">// Before CakePHP 3.2. Write to stderr and exit()</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;Fatal error&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>It also provides two convenience methods regarding the output level:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Would only appear when verbose output is enabled (-v)</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">verbose</span><span class="p">(</span><span class="s1">&#39;Verbose message&#39;</span><span class="p">);</span>

<span class="c1">// Would appear at all levels.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">quiet</span><span class="p">(</span><span class="s1">&#39;Quiet message&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Shell also includes methods for clearing output, creating blank lines, or
drawing a line of dashes:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Output 2 newlines</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nl</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

<span class="c1">// Clear the user&#39;s screen</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">clear</span><span class="p">();</span>

<span class="c1">// Draw a horizontal line</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hr</span><span class="p">();</span>
</pre></div>
</div>
<p>Lastly, you can update the current line of text on the screen using
<code class="docutils literal"><span class="pre">_io-&gt;overwrite()</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Counting down&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_io</span><span class="o">-&gt;</span><span class="na">overwrite</span><span class="p">(</span><span class="nv">$i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is important to remember, that you cannot overwrite text
once a new line has been output.</p>
<div class="section" id="console-output-levels">
<span id="shell-output-level"></span><h3>Console Output Levels<a class="headerlink" href="#console-output-levels" title="Permalink to this headline">¶</a></h3>
<p>Shells often need different levels of verbosity. When running as cron jobs,
most output is un-necessary. And there are times when you are not interested in
everything that a shell has to say. You can use output levels to flag output
appropriately. The user of the shell, can then decide what level of detail
they are interested in by setting the correct flag when calling the shell.
<code class="xref php php-meth docutils literal"><span class="pre">Cake\Console\Shell::out()</span></code> supports 3 types of output by default.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">QUIET</span></code> - Only absolutely important information should be marked for quiet
output.</li>
<li><code class="docutils literal"><span class="pre">NORMAL</span></code> - The default level, and normal usage.</li>
<li><code class="docutils literal"><span class="pre">VERBOSE</span></code> - Mark messages that may be too noisy for everyday use, but
helpful for debugging as <code class="docutils literal"><span class="pre">VERBOSE</span></code>.</li>
</ul>
<p>You can mark output as follows:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Would appear at all levels.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Quiet message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">QUIET</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">quiet</span><span class="p">(</span><span class="s1">&#39;Quiet message&#39;</span><span class="p">);</span>

<span class="c1">// Would not appear when quiet output is toggled.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;normal message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">NORMAL</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;loud message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">VERBOSE</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">verbose</span><span class="p">(</span><span class="s1">&#39;Verbose output&#39;</span><span class="p">);</span>

<span class="c1">// Would only appear when verbose output is enabled.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;extra message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">VERBOSE</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">verbose</span><span class="p">(</span><span class="s1">&#39;Verbose output&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can control the output level of shells, by using the <code class="docutils literal"><span class="pre">--quiet</span></code> and
<code class="docutils literal"><span class="pre">--verbose</span></code> options. These options are added by default, and allow you to
consistently control output levels inside your CakePHP shells.</p>
<p>The <code class="docutils literal"><span class="pre">--quiet</span></code> and <code class="docutils literal"><span class="pre">--verbose</span></code> options also control how logging data is
output to stdout/stderr. Normally info and higher log messages are output to
stdout/stderr. When <code class="docutils literal"><span class="pre">--verbose</span></code> is used, debug logs will be output to stdout.
When <code class="docutils literal"><span class="pre">--quiet</span></code> is used, only warning and higher log messages will be output to
stderr.</p>
</div>
<div class="section" id="styling-output">
<h3>Styling Output<a class="headerlink" href="#styling-output" title="Permalink to this headline">¶</a></h3>
<p>Styling output is done by including tags - just like HTML - in your output.
ConsoleOutput will replace these tags with the correct ansi code sequence, or
remove the tags if you are on a console that doesn&#8217;t support ansi codes. There
are several built-in styles, and you can create more. The built-in ones are</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">success</span></code> Success messages. Green text.</li>
<li><code class="docutils literal"><span class="pre">error</span></code> Error messages. Red text.</li>
<li><code class="docutils literal"><span class="pre">warning</span></code> Warning messages. Yellow text.</li>
<li><code class="docutils literal"><span class="pre">info</span></code> Informational messages. Cyan text.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> Additional text. Blue text.</li>
<li><code class="docutils literal"><span class="pre">question</span></code> Text that is a question, added automatically by shell.</li>
</ul>
<p>You can create additional styles using <code class="docutils literal"><span class="pre">$this-&gt;stdout-&gt;styles()</span></code>. To declare a
new output style you could do:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_io</span><span class="o">-&gt;</span><span class="na">styles</span><span class="p">(</span><span class="s1">&#39;flashy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;blink&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">]);</span>
</pre></div>
</div>
<p>This would then allow you to use a <code class="docutils literal"><span class="pre">&lt;flashy&gt;</span></code> tag in your shell output, and if
ansi colours are enabled, the following would be rendered as blinking magenta
text <code class="docutils literal"><span class="pre">$this-&gt;out('&lt;flashy&gt;Whoooa&lt;/flashy&gt;</span> <span class="pre">Something</span> <span class="pre">went</span> <span class="pre">wrong');</span></code>. When
defining styles you can use the following colours for the <code class="docutils literal"><span class="pre">text</span></code> and
<code class="docutils literal"><span class="pre">background</span></code> attributes:</p>
<ul class="simple">
<li>black</li>
<li>blue</li>
<li>cyan</li>
<li>green</li>
<li>magenta</li>
<li>red</li>
<li>white</li>
<li>yellow</li>
</ul>
<p>You can also use the following options as boolean switches, setting them to a
truthy value enables them.</p>
<ul class="simple">
<li>blink</li>
<li>bold</li>
<li>reverse</li>
<li>underline</li>
</ul>
<p>Adding a style makes it available on all instances of ConsoleOutput as well,
so you don&#8217;t have to redeclare styles for both stdout and stderr objects.</p>
</div>
<div class="section" id="turning-off-colouring">
<h3>Turning Off Colouring<a class="headerlink" href="#turning-off-colouring" title="Permalink to this headline">¶</a></h3>
<p>Although colouring is pretty awesome, there may be times when you want to turn it off,
or force it on:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_io</span><span class="o">-&gt;</span><span class="na">outputAs</span><span class="p">(</span><span class="nx">ConsoleOutput</span><span class="o">::</span><span class="na">RAW</span><span class="p">);</span>
</pre></div>
</div>
<p>The above will put the output object into raw output mode. In raw output mode,
no styling is done at all. There are three modes you can use.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ConsoleOutput::COLOR</span></code> - Output with color escape codes in place.</li>
<li><code class="docutils literal"><span class="pre">ConsoleOutput::PLAIN</span></code> - Plain text output, known style tags will be
stripped from the output.</li>
<li><code class="docutils literal"><span class="pre">ConsoleOutput::RAW</span></code> - Raw output, no styling or formatting will be done.
This is a good mode to use if you are outputting XML or, want to debug why
your styling isn&#8217;t working.</li>
</ul>
<p>By default on *nix systems ConsoleOutput objects default to colour output.
On Windows systems, plain output is the default unless the <code class="docutils literal"><span class="pre">ANSICON</span></code>
environment variable is present.</p>
</div>
</div>
<div class="section" id="stopping-shell-execution">
<h2>Stopping Shell Execution<a class="headerlink" href="#stopping-shell-execution" title="Permalink to this headline">¶</a></h2>
<p>When your shell commands have reached a condition where you want execution to
stop, you can use <code class="docutils literal"><span class="pre">abort()</span></code> to raise a <code class="docutils literal"><span class="pre">StopException</span></code> that will halt the
process:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Users</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Halt with an error message and error code.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">abort</span><span class="p">(</span><span class="s1">&#39;User cannot be found&#39;</span><span class="p">,</span> <span class="mi">128</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2: </span>The abort() method was added in 3.2. In prior versions you can use
<code class="docutils literal"><span class="pre">error()</span></code> to output a message and stop execution.</p>
</div>
<div class="section" id="status-and-error-codes">
<h3>Status and Error Codes<a class="headerlink" href="#status-and-error-codes" title="Permalink to this headline">¶</a></h3>
<p>Command-line tools should return 0 to indicate success, or a non-zero value to
indicate an error condition. Since PHP methods usually return <code class="docutils literal"><span class="pre">true</span></code> or
<code class="docutils literal"><span class="pre">false</span></code>, the Cake Shell <code class="docutils literal"><span class="pre">dispatch</span></code> function helps to bridge these semantics
by converting your <code class="docutils literal"><span class="pre">null</span></code> and <code class="docutils literal"><span class="pre">true</span></code> return values to 0, and all other
values to 1.</p>
<p>The Cake Shell <code class="docutils literal"><span class="pre">dispatch</span></code> function also catches the <code class="docutils literal"><span class="pre">StopException</span></code> and
uses its exception code value as the shell&#8217;s exit code. As described above, you
can use the <code class="docutils literal"><span class="pre">abort()</span></code> method to print a message and exit with a specific
code, or raise the <code class="docutils literal"><span class="pre">StopException</span></code> directly as shown in the example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Shell\Task</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Console\Shell</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ErroneousShell</span> <span class="k">extends</span> <span class="nx">Shell</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">itFails</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">itFailsSpecifically</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">StopException</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The example above will return the following exit codes when executed on a
command-line:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">erroneousshell</span> <span class="p">;</span> <span class="k">echo</span> <span class="err">$</span><span class="o">?</span>
<span class="mi">0</span>
<span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">erroneousshell</span> <span class="nx">itFails</span> <span class="p">;</span> <span class="k">echo</span> <span class="err">$</span><span class="o">?</span>
<span class="mi">1</span>
<span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">erroneousshell</span> <span class="nx">itFailsSpecifically</span> <span class="p">;</span> <span class="k">echo</span> <span class="err">$</span><span class="o">?</span>
<span class="mi">2</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Avoid exit codes 64 - 78, as they have specific meanings described by
<code class="docutils literal"><span class="pre">sysexits.h</span></code>.
Avoid exit codes above 127, as these are used to indicate process exit
by signal, such as SIGKILL or SIGSEGV.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can read more about conventional exit codes in the sysexit manual page
on most Unix systems (<code class="docutils literal"><span class="pre">man</span> <span class="pre">sysexits</span></code>), or the <code class="docutils literal"><span class="pre">System</span> <span class="pre">Error</span> <span class="pre">Codes</span></code> help
page in Windows.</p>
</div>
</div>
</div>
<div class="section" id="hook-methods">
<h2>Hook Methods<a class="headerlink" href="#hook-methods" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\Console\Shell::initialize">
<code class="descclassname">Cake\Console\Shell::</code><code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\Shell::initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the Shell, acts as constructor for subclasses and allows
configuration of tasks prior to shell execution.</p>
</dd></dl>

<dl class="method">
<dt id="Cake\Console\Shell::startup">
<code class="descclassname">Cake\Console\Shell::</code><code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\Shell::startup" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts up the Shell and displays the welcome message. Allows for checking
and configuring prior to command or main execution.</p>
</dd></dl>

<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Override the <code class="docutils literal"><span class="pre">startup()</span></code> method if you want to remove the welcome
information, or otherwise modify the pre-command flow.</p>
</div>
</div>
<div class="section" id="configuring-options-and-generating-help">
<h2>Configuring Options and Generating Help<a class="headerlink" href="#configuring-options-and-generating-help" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Cake\Console\ConsoleOptionParser">
<em class="property">class </em><code class="descclassname">Cake\Console\</code><code class="descname">ConsoleOptionParser</code><a class="headerlink" href="#Cake\Console\ConsoleOptionParser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><code class="docutils literal"><span class="pre">ConsoleOptionParser</span></code> provides a command line option and
argument parser.</p>
<p>OptionParsers allow you to accomplish two goals at the same time. First, they
allow you to define the options and arguments for your commands. This allows
you to separate basic input validation and your console commands. Secondly, it
allows you to provide documentation, that is used to generate a well formatted
help file.</p>
<p>The console framework in CakePHP gets your shell&#8217;s option parser by calling
<code class="docutils literal"><span class="pre">$this-&gt;getOptionParser()</span></code>. Overriding this method allows you to configure the
OptionParser to define the expected inputs of your shell. You can also configure
subcommand option parsers, which allow you to have different option parsers for
subcommands and tasks. The ConsoleOptionParser implements a fluent interface and
includes methods for setting multiple options/arguments at once:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getOptionParser</span><span class="p">();</span>
    <span class="c1">// Configure parser</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="configuring-an-option-parser-with-the-fluent-interface">
<h3>Configuring an Option Parser with the Fluent Interface<a class="headerlink" href="#configuring-an-option-parser-with-the-fluent-interface" title="Permalink to this headline">¶</a></h3>
<p>All of the methods that configure an option parser can be chained, allowing you
to define an entire option parser in one series of method calls:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getOptionParser</span><span class="p">();</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Either a full path or type of class.&#39;</span>
    <span class="p">])</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;A CakePHP core class name (e.g: Component, HtmlHelper).&#39;</span>
    <span class="p">])</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;The specific method you want help on.&#39;</span><span class="p">)</span>
    <span class="p">])</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Lookup doc block comments for classes in CakePHP.&#39;</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The methods that allow chaining are:</p>
<ul class="simple">
<li>addArgument()</li>
<li>addArguments()</li>
<li>addOption()</li>
<li>addOptions()</li>
<li>addSubcommand()</li>
<li>addSubcommands()</li>
<li>setCommand()</li>
<li>setDescription()</li>
<li>setEpilog()</li>
</ul>
<div class="section" id="set-the-description">
<h4>Set the Description<a class="headerlink" href="#set-the-description" title="Permalink to this headline">¶</a></h4>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::setDescription">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">setDescription</code><span class="sig-paren">(</span><em>$text</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::setDescription" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The description displays above the argument and option information. By passing
in either an array or a string, you can set the value of the description:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Set multiple lines at once</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">([</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">]);</span>
<span class="c1">// Prior to 3.4</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">([</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">]);</span>

<span class="c1">// Read the current value</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">getDescription</span><span class="p">();</span>
</pre></div>
</div>
<p>The <strong>src/Shell/ConsoleShell.php</strong> is a good example of the <code class="docutils literal"><span class="pre">description()</span></code>
method in action:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * Display help for this console.</span>
<span class="sd"> *</span>
<span class="sd"> * @return ConsoleOptionParser</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ConsoleOptionParser</span><span class="p">(</span><span class="s1">&#39;console&#39;</span><span class="p">);</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span>
        <span class="s1">&#39;This shell provides a REPL that you can use to interact &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;with your application in an interactive fashion. You can use &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;it to run adhoc queries with your models, or experiment &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;and explore the features of CakePHP and your application.&#39;</span> <span class="o">.</span>
        <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
        <span class="s1">&#39;You will need to have psysh installed for this Shell to work.&#39;</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The console&#8217;s <code class="docutils literal"><span class="pre">description</span></code> output can be seen by executing the following
command:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">console</span> <span class="o">--</span><span class="nx">help</span>

<span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">CakePHP</span> <span class="nx">v3</span><span class="o">.</span><span class="mf">0.13</span> <span class="nx">Console</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">App</span> <span class="o">:</span> <span class="nx">src</span>
<span class="nx">Path</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">user</span><span class="o">/</span><span class="nx">cakeblog</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span>
<span class="o">---------------------------------------------------------------</span>
<span class="k">This</span> <span class="nx">shell</span> <span class="nx">provides</span> <span class="nx">a</span> <span class="nx">REPL</span> <span class="nx">that</span> <span class="nx">you</span> <span class="nx">can</span> <span class="k">use</span> <span class="nx">to</span> <span class="nx">interact</span> <span class="nx">with</span> <span class="nx">your</span>
<span class="nx">application</span> <span class="nx">in</span> <span class="nx">an</span> <span class="nx">interactive</span> <span class="nx">fashion</span><span class="o">.</span> <span class="nx">You</span> <span class="nx">can</span> <span class="k">use</span> <span class="nx">it</span> <span class="nx">to</span> <span class="nx">run</span> <span class="nx">adhoc</span>
<span class="nx">queries</span> <span class="nx">with</span> <span class="nx">your</span> <span class="nx">models</span><span class="p">,</span> <span class="k">or</span> <span class="nx">experiment</span> <span class="k">and</span> <span class="nx">explore</span> <span class="nx">the</span> <span class="nx">features</span> <span class="nx">of</span>
<span class="nx">CakePHP</span> <span class="k">and</span> <span class="nx">your</span> <span class="nx">application</span><span class="o">.</span>

<span class="nx">You</span> <span class="nx">will</span> <span class="nx">need</span> <span class="nx">to</span> <span class="nx">have</span> <span class="nx">psysh</span> <span class="nx">installed</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">Shell</span> <span class="nx">to</span> <span class="nx">work</span><span class="o">.</span>

<span class="nx">Usage</span><span class="o">:</span>
<span class="nx">cake</span> <span class="nx">console</span> <span class="p">[</span><span class="o">-</span><span class="nx">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">v</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">q</span><span class="p">]</span>

<span class="nx">Options</span><span class="o">:</span>

<span class="o">--</span><span class="nx">help</span><span class="p">,</span> <span class="o">-</span><span class="nx">h</span>     <span class="nx">Display</span> <span class="k">this</span> <span class="nx">help</span><span class="o">.</span>
<span class="o">--</span><span class="nx">verbose</span><span class="p">,</span> <span class="o">-</span><span class="nx">v</span>  <span class="nx">Enable</span> <span class="nx">verbose</span> <span class="nx">output</span><span class="o">.</span>
<span class="o">--</span><span class="nx">quiet</span><span class="p">,</span> <span class="o">-</span><span class="nx">q</span>    <span class="nx">Enable</span> <span class="nx">quiet</span> <span class="nx">output</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="set-a-help-alias">
<h4>Set a help alias<a class="headerlink" href="#set-a-help-alias" title="Permalink to this headline">¶</a></h4>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::setHelpAlias">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">setHelpAlias</code><span class="sig-paren">(</span><em>$alias</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::setHelpAlias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you want to change the command name, you can use the <code class="docutils literal"><span class="pre">setHelpAlias()</span></code> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setHelpAlias</span><span class="p">(</span><span class="s1">&#39;my-shell&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>This will change the usage output to <code class="docutils literal"><span class="pre">my-shell</span></code> instead of the default <code class="docutils literal"><span class="pre">cake</span></code> value:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">Usage</span><span class="o">:</span>
<span class="nx">my</span><span class="o">-</span><span class="nx">shell</span> <span class="nx">console</span> <span class="p">[</span><span class="o">-</span><span class="nx">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">v</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">q</span><span class="p">]</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.5.0: </span>The <code class="docutils literal"><span class="pre">setHelpAlias</span></code> method was added in 3.5.0</p>
</div>
</div>
</div>
<div class="section" id="set-the-epilog">
<h3>Set the Epilog<a class="headerlink" href="#set-the-epilog" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::setEpilog">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">setEpilog</code><span class="sig-paren">(</span><em>$text</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::setEpilog" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Gets or sets the epilog for the option parser. The epilog is displayed after the
argument and option information. By passing in either an array or a string, you
can set the value of the epilog. Calling with no arguments will return the
current value:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Set multiple lines at once</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setEpilog</span><span class="p">([</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">]);</span>
<span class="c1">// Prior to 3.4</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">epilog</span><span class="p">([</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">]);</span>

<span class="c1">// Read the current value</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">getEpilog</span><span class="p">();</span>
</pre></div>
</div>
<p>To illustrate the <code class="docutils literal"><span class="pre">epilog()</span></code> method in action lets add a call to the
<code class="docutils literal"><span class="pre">getOptionParser()</span></code> method used above in the <strong>src/Shell/ConsoleShell.php</strong>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * Display help for this console.</span>
<span class="sd"> *</span>
<span class="sd"> * @return ConsoleOptionParser</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ConsoleOptionParser</span><span class="p">(</span><span class="s1">&#39;console&#39;</span><span class="p">);</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span>
        <span class="s1">&#39;This shell provides a REPL that you can use to interact &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;with your application in an interactive fashion. You can use &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;it to run adhoc queries with your models, or experiment &#39;</span> <span class="o">.</span>
        <span class="s1">&#39;and explore the features of CakePHP and your application.&#39;</span> <span class="o">.</span>
        <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">.</span>
        <span class="s1">&#39;You will need to have psysh installed for this Shell to work.&#39;</span>
    <span class="p">);</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">setEpilog</span><span class="p">(</span><span class="s1">&#39;Thank you for baking with CakePHP!&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The text added with the <code class="docutils literal"><span class="pre">setEpilog()</span></code> method can be seen in the output from
the following console command:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">console</span> <span class="o">--</span><span class="nx">help</span>

<span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">CakePHP</span> <span class="nx">v3</span><span class="o">.</span><span class="mf">0.13</span> <span class="nx">Console</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">App</span> <span class="o">:</span> <span class="nx">src</span>
<span class="nx">Path</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">user</span><span class="o">/</span><span class="nx">cakeblog</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span>
<span class="o">---------------------------------------------------------------</span>
<span class="k">This</span> <span class="nx">shell</span> <span class="nx">provides</span> <span class="nx">a</span> <span class="nx">REPL</span> <span class="nx">that</span> <span class="nx">you</span> <span class="nx">can</span> <span class="k">use</span> <span class="nx">to</span> <span class="nx">interact</span> <span class="nx">with</span> <span class="nx">your</span>
<span class="nx">application</span> <span class="nx">in</span> <span class="nx">an</span> <span class="nx">interactive</span> <span class="nx">fashion</span><span class="o">.</span> <span class="nx">You</span> <span class="nx">can</span> <span class="k">use</span> <span class="nx">it</span> <span class="nx">to</span> <span class="nx">run</span> <span class="nx">adhoc</span>
<span class="nx">queries</span> <span class="nx">with</span> <span class="nx">your</span> <span class="nx">models</span><span class="p">,</span> <span class="k">or</span> <span class="nx">experiment</span> <span class="k">and</span> <span class="nx">explore</span> <span class="nx">the</span> <span class="nx">features</span> <span class="nx">of</span>
<span class="nx">CakePHP</span> <span class="k">and</span> <span class="nx">your</span> <span class="nx">application</span><span class="o">.</span>

<span class="nx">You</span> <span class="nx">will</span> <span class="nx">need</span> <span class="nx">to</span> <span class="nx">have</span> <span class="nx">psysh</span> <span class="nx">installed</span> <span class="k">for</span> <span class="k">this</span> <span class="nx">Shell</span> <span class="nx">to</span> <span class="nx">work</span><span class="o">.</span>

<span class="nx">Usage</span><span class="o">:</span>
<span class="nx">cake</span> <span class="nx">console</span> <span class="p">[</span><span class="o">-</span><span class="nx">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">v</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nx">q</span><span class="p">]</span>

<span class="nx">Options</span><span class="o">:</span>

<span class="o">--</span><span class="nx">help</span><span class="p">,</span> <span class="o">-</span><span class="nx">h</span>     <span class="nx">Display</span> <span class="k">this</span> <span class="nx">help</span><span class="o">.</span>
<span class="o">--</span><span class="nx">verbose</span><span class="p">,</span> <span class="o">-</span><span class="nx">v</span>  <span class="nx">Enable</span> <span class="nx">verbose</span> <span class="nx">output</span><span class="o">.</span>
<span class="o">--</span><span class="nx">quiet</span><span class="p">,</span> <span class="o">-</span><span class="nx">q</span>    <span class="nx">Enable</span> <span class="nx">quiet</span> <span class="nx">output</span><span class="o">.</span>

<span class="nx">Thank</span> <span class="nx">you</span> <span class="k">for</span> <span class="nx">baking</span> <span class="nx">with</span> <span class="nx">CakePHP</span><span class="o">!</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-arguments">
<h3>Adding Arguments<a class="headerlink" href="#adding-arguments" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::addArgument">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">addArgument</code><span class="sig-paren">(</span><em>$name</em>, <em>$params = []</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::addArgument" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Positional arguments are frequently used in command line tools,
and <code class="docutils literal"><span class="pre">ConsoleOptionParser</span></code> allows you to define positional
arguments as well as make them required. You can add arguments
one at a time with <code class="docutils literal"><span class="pre">$parser-&gt;addArgument();</span></code> or multiple at once
with <code class="docutils literal"><span class="pre">$parser-&gt;addArguments();</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The model to bake&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<p>You can use the following options when creating an argument:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">help</span></code> The help text to display for this argument.</li>
<li><code class="docutils literal"><span class="pre">required</span></code> Whether this parameter is required.</li>
<li><code class="docutils literal"><span class="pre">index</span></code> The index for the arg, if left undefined the argument will be put
onto the end of the arguments. If you define the same index twice the
first option will be overwritten.</li>
<li><code class="docutils literal"><span class="pre">choices</span></code> An array of valid choices for this argument. If left empty all
values are valid. An exception will be raised when parse() encounters an
invalid value.</li>
</ul>
<p>Arguments that have been marked as required will throw an exception when
parsing the command if they have been omitted. So you don&#8217;t have to
handle that in your shell.</p>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::addArguments">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">addArguments</code><span class="sig-paren">(</span><em>array $args</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::addArguments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you have an array with multiple arguments you can use
<code class="docutils literal"><span class="pre">$parser-&gt;addArguments()</span></code> to add multiple arguments at once.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArguments</span><span class="p">([</span>
    <span class="s1">&#39;node&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The node to create&#39;</span><span class="p">,</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">],</span>
    <span class="s1">&#39;parent&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The parent node&#39;</span><span class="p">,</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>As with all the builder methods on ConsoleOptionParser, addArguments
can be used as part of a fluent method chain.</p>
</div>
<div class="section" id="validating-arguments">
<h3>Validating Arguments<a class="headerlink" href="#validating-arguments" title="Permalink to this headline">¶</a></h3>
<p>When creating positional arguments, you can use the <code class="docutils literal"><span class="pre">required</span></code> flag, to
indicate that an argument must be present when a shell is called.
Additionally you can use <code class="docutils literal"><span class="pre">choices</span></code> to force an argument to be from a list of
valid choices:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The type of node to interact with.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;aro&#39;</span><span class="p">,</span> <span class="s1">&#39;aco&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The above will create an argument that is required and has validation on the
input. If the argument is either missing, or has an incorrect value an exception
will be raised and the shell will be stopped.</p>
</div>
<div class="section" id="adding-options">
<h3>Adding Options<a class="headerlink" href="#adding-options" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::addOption">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">addOption</code><span class="sig-paren">(</span><em>$name</em>, <em>$options = []</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::addOption" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Options or flags are also frequently used in command line tools.
<code class="docutils literal"><span class="pre">ConsoleOptionParser</span></code> supports creating options with both verbose and short
aliases, supplying defaults and creating boolean switches. Options are created
with either <code class="docutils literal"><span class="pre">$parser-&gt;addOption()</span></code> or <code class="docutils literal"><span class="pre">$parser-&gt;addOptions()</span></code>.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;connection&#39;</span><span class="p">,</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The above would allow you to use either <code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--connection=other</span></code>,
<code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--connection</span> <span class="pre">other</span></code>, or <code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">-c</span> <span class="pre">other</span></code>
when invoking the shell. You can also create boolean switches, these switches do
not consume values, and their presence just enables them in the parsed
parameters.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;no-commit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;boolean&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">]);</span>
</pre></div>
</div>
<p>With this option, when calling a shell like
<code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--no-commit</span> <span class="pre">something</span></code> the no-commit param would have a value of
<code class="docutils literal"><span class="pre">true</span></code>, and &#8216;something&#8217; would be a treated as a positional argument.
The built-in <code class="docutils literal"><span class="pre">--help</span></code>, <code class="docutils literal"><span class="pre">--verbose</span></code>, and <code class="docutils literal"><span class="pre">--quiet</span></code> options use this
feature.</p>
<p>When creating options you can use the following options to define the behavior
of the option:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">short</span></code> - The single letter variant for this option, leave undefined for</dt>
<dd>none.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">help</span></code> - Help text for this option. Used when generating help for the</dt>
<dd>option.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">default</span></code> - The default value for this option. If not defined the default</dt>
<dd>will be <code class="docutils literal"><span class="pre">true</span></code>.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">boolean</span></code> - The option uses no value, it&#8217;s just a boolean switch.
Defaults to <code class="docutils literal"><span class="pre">false</span></code>.</li>
<li><code class="docutils literal"><span class="pre">choices</span></code> - An array of valid choices for this option. If left empty all
values are valid. An exception will be raised when parse() encounters an
invalid value.</li>
</ul>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::addOptions">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">addOptions</code><span class="sig-paren">(</span><em>array $options</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::addOptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you have an array with multiple options you can use <code class="docutils literal"><span class="pre">$parser-&gt;addOptions()</span></code>
to add multiple options at once.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOptions</span><span class="p">([</span>
    <span class="s1">&#39;node&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The node to create&#39;</span><span class="p">],</span>
    <span class="s1">&#39;parent&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The parent node&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>As with all the builder methods on ConsoleOptionParser, addOptions can be used
as part of a fluent method chain.</p>
<p>Option values are stored in the <code class="docutils literal"><span class="pre">$this-&gt;params</span></code> array. You can also use the
convenience method <code class="docutils literal"><span class="pre">$this-&gt;param()</span></code> to avoid errors when trying to access
non-present options.</p>
</div>
<div class="section" id="validating-options">
<h3>Validating Options<a class="headerlink" href="#validating-options" title="Permalink to this headline">¶</a></h3>
<p>Options can be provided with a set of choices much like positional arguments
can be. When an option has defined choices, those are the only valid choices
for an option. All other values will raise an <code class="docutils literal"><span class="pre">InvalidArgumentException</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;accept&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;What version to accept.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;working&#39;</span><span class="p">,</span> <span class="s1">&#39;theirs&#39;</span><span class="p">,</span> <span class="s1">&#39;mine&#39;</span><span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="using-boolean-options">
<h3>Using Boolean Options<a class="headerlink" href="#using-boolean-options" title="Permalink to this headline">¶</a></h3>
<p>Options can be defined as boolean options, which are useful when you need to
create some flag options. Like options with defaults, boolean options always
include themselves into the parsed parameters. When the flags are present they
are set to <code class="docutils literal"><span class="pre">true</span></code>, when they are absent they are set to <code class="docutils literal"><span class="pre">false</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Enable verbose output.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;boolean&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The following option would result in <code class="docutils literal"><span class="pre">$this-&gt;params['verbose']</span></code> always being
available. This lets you omit <code class="docutils literal"><span class="pre">empty()</span></code> or <code class="docutils literal"><span class="pre">isset()</span></code> checks for boolean
flags:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// Do something.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the boolean options are always defined as <code class="docutils literal"><span class="pre">true</span></code> or <code class="docutils literal"><span class="pre">false</span></code> you can
omit additional check methods when using the array access. The
<code class="docutils literal"><span class="pre">$this-&gt;param()</span></code> method makes these checks unnecessary for all cases.</p>
</div>
<div class="section" id="adding-subcommands">
<h3>Adding Subcommands<a class="headerlink" href="#adding-subcommands" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::addSubcommand">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">addSubcommand</code><span class="sig-paren">(</span><em>$name</em>, <em>$options = []</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::addSubcommand" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Console applications are often made of subcommands, and these subcommands may
require special option parsing and have their own help. A perfect example of
this is <code class="docutils literal"><span class="pre">bake</span></code>. Bake is made of many separate tasks that all have their own
help and options. <code class="docutils literal"><span class="pre">ConsoleOptionParser</span></code> allows you to define subcommands and
provide command specific option parsers so the shell knows how to parse commands
for its tasks:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addSubcommand</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bake a model&#39;</span><span class="p">,</span>
    <span class="s1">&#39;parser&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Model</span><span class="o">-&gt;</span><span class="na">getOptionParser</span><span class="p">()</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>The above is an example of how you could provide help and a specialized option
parser for a shell&#8217;s task. By calling the Task&#8217;s <code class="docutils literal"><span class="pre">getOptionParser()</span></code> we don&#8217;t
have to duplicate the option parser generation, or mix concerns in our shell.
Adding subcommands in this way has two advantages. First, it lets your shell
document its subcommands in the generated help. It also gives easy access to the
subcommand help. With the above subcommand created you could call
<code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--help</span></code> and see the list of subcommands, and also run
<code class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">model</span> <span class="pre">--help</span></code> to view the help for just the model task.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Once your Shell defines subcommands, all subcommands must be explicitly
defined.</p>
</div>
<p>When defining a subcommand you can use the following options:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">help</span></code> - Help text for the subcommand.</li>
<li><code class="docutils literal"><span class="pre">parser</span></code> - A ConsoleOptionParser for the subcommand. This allows you to
create method specific option parsers. When help is generated for a
subcommand, if a parser is present it will be used. You can also supply the
parser as an array that is compatible with
<a class="reference internal" href="#Cake\Console\ConsoleOptionParser::buildFromArray" title="Cake\Console\ConsoleOptionParser::buildFromArray"><code class="xref php php-meth docutils literal"><span class="pre">Cake\Console\ConsoleOptionParser::buildFromArray()</span></code></a></li>
</ul>
<p>Adding subcommands can be done as part of a fluent method chain.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.5.0: </span>When adding multi-word subcommands you can now invoke those commands using
<code class="docutils literal"><span class="pre">snake_case</span></code> in addition to the camelBacked form.</p>
</div>
</div>
<div class="section" id="building-a-consoleoptionparser-from-an-array">
<h3>Building a ConsoleOptionParser from an Array<a class="headerlink" href="#building-a-consoleoptionparser-from-an-array" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::buildFromArray">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">buildFromArray</code><span class="sig-paren">(</span><em>$spec</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::buildFromArray" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>As previously mentioned, when creating subcommand option parsers, you can define
the parser spec as an array for that method. This can help make building
subcommand parsers easier, as everything is an array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addSubcommand</span><span class="p">(</span><span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Check the permissions between an ACO and ARO.&#39;</span><span class="p">),</span>
    <span class="s1">&#39;parser&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;Use this command to grant ACL permissions. Once executed, the &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;ARO specified (and its children, if any) will have ALLOW access &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;to the specified ACO action (and the ACO&#39;s children, if any).&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s1">&#39;arguments&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;aro&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ARO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">],</span>
            <span class="s1">&#39;aco&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ACO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">],</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Action to check&#39;</span><span class="p">)]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>Inside the parser spec, you can define keys for <code class="docutils literal"><span class="pre">arguments</span></code>, <code class="docutils literal"><span class="pre">options</span></code>,
<code class="docutils literal"><span class="pre">description</span></code> and <code class="docutils literal"><span class="pre">epilog</span></code>. You cannot define <code class="docutils literal"><span class="pre">subcommands</span></code> inside an
array style builder. The values for arguments, and options, should follow the
format that <a class="reference internal" href="#Cake\Console\ConsoleOptionParser::addArguments" title="Cake\Console\ConsoleOptionParser::addArguments"><code class="xref php php-func docutils literal"><span class="pre">Cake\Console\ConsoleOptionParser::addArguments()</span></code></a> and
<a class="reference internal" href="#Cake\Console\ConsoleOptionParser::addOptions" title="Cake\Console\ConsoleOptionParser::addOptions"><code class="xref php php-func docutils literal"><span class="pre">Cake\Console\ConsoleOptionParser::addOptions()</span></code></a> use. You can also
use buildFromArray on its own, to build an option parser:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nx">ConsoleOptionParser</span><span class="o">::</span><span class="na">buildFromArray</span><span class="p">([</span>
        <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;Use this command to grant ACL permissions. Once executed, the &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;ARO specified (and its children, if any) will have ALLOW access &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;to the specified ACO action (and the ACO&#39;s children, if any).&quot;</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s1">&#39;arguments&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;aro&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ARO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">],</span>
            <span class="s1">&#39;aco&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ACO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">],</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Action to check&#39;</span><span class="p">)]</span>
        <span class="p">]</span>
    <span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-consoleoptionparsers">
<h3>Merging ConsoleOptionParsers<a class="headerlink" href="#merging-consoleoptionparsers" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="Cake\Console\ConsoleOptionParser::merge">
<code class="descclassname">Cake\Console\ConsoleOptionParser::</code><code class="descname">merge</code><span class="sig-paren">(</span><em>$spec</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\Console\ConsoleOptionParser::merge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>When building a group command, you maybe want to combine several parsers for
this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">merge</span><span class="p">(</span><span class="nv">$anotherParser</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that the order of arguments for each parser must be the same, and that
options must also be compatible for it work. So do not use keys for different
things.</p>
</div>
<div class="section" id="getting-help-from-shells">
<h3>Getting Help from Shells<a class="headerlink" href="#getting-help-from-shells" title="Permalink to this headline">¶</a></h3>
<p>With the addition of ConsoleOptionParser getting help from shells is done in a
consistent and uniform way. By using the <code class="docutils literal"><span class="pre">--help</span></code> or -<code class="docutils literal"><span class="pre">h</span></code> option you
can view the help for any core shell, and any shell that implements a
ConsoleOptionParser:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">cake</span> <span class="nx">bake</span> <span class="o">--</span><span class="nx">help</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="o">-</span><span class="nx">h</span>
</pre></div>
</div>
<p>Would both generate the help for bake. If the shell supports subcommands you can
get help for those in a similar fashion:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">model</span> <span class="o">--</span><span class="nx">help</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">model</span> <span class="o">-</span><span class="nx">h</span>
</pre></div>
</div>
<p>This would get you the help specific to bake&#8217;s model task.</p>
</div>
<div class="section" id="getting-help-as-xml">
<h3>Getting Help as XML<a class="headerlink" href="#getting-help-as-xml" title="Permalink to this headline">¶</a></h3>
<p>When building automated tools or development tools that need to interact with
CakePHP shells, it&#8217;s nice to have help available in a machine parse-able format.
The ConsoleOptionParser can provide help in xml by setting an additional
argument:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">cake</span> <span class="nx">bake</span> <span class="o">--</span><span class="nx">help</span> <span class="nx">xml</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="o">-</span><span class="nx">h</span> <span class="nx">xml</span>
</pre></div>
</div>
<p>The above would return an XML document with the generated help, options,
arguments and subcommands for the selected shell. A sample XML document would
look like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;shell&gt;</span>
    <span class="nt">&lt;command&gt;</span>bake fixture<span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;description&gt;</span>Generate fixtures for use with the test suite. You can use
        `bake fixture all` to bake all fixtures.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;epilog&gt;</span>
        Omitting all arguments and options will enter into an interactive
        mode.
    <span class="nt">&lt;/epilog&gt;</span>
    <span class="nt">&lt;subcommands/&gt;</span>
    <span class="nt">&lt;options&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--help&quot;</span> <span class="na">short=</span><span class="s">&quot;-h&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--verbose&quot;</span> <span class="na">short=</span><span class="s">&quot;-v&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--quiet&quot;</span> <span class="na">short=</span><span class="s">&quot;-q&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--count&quot;</span> <span class="na">short=</span><span class="s">&quot;-n&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default&gt;</span>10<span class="nt">&lt;/default&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--connection&quot;</span> <span class="na">short=</span><span class="s">&quot;-c&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default&gt;</span>default<span class="nt">&lt;/default&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--plugin&quot;</span> <span class="na">short=</span><span class="s">&quot;-p&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--records&quot;</span> <span class="na">short=</span><span class="s">&quot;-r&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/options&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="na">help=</span><span class="s">&quot;Name of the fixture to bake.</span>
<span class="s">            Can use Plugin.name to bake plugin fixtures.&quot;</span> <span class="na">required=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/shell&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="renaming-commands">
<h2>Renaming Commands<a class="headerlink" href="#renaming-commands" title="Permalink to this headline">¶</a></h2>
<p>By default CakePHP will automatically discover all the commands in your
application and its plugins. You may want to reduce the number of exposed
commands, when building standalone console applications. You can use your
Application&#8217;s <code class="docutils literal"><span class="pre">console()</span></code> hook to limit which commands are exposed and rename
the commands that are exposed:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Shell\UserShell</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Shell\VersionShell</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Cake\Http\BaseApplication</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Application</span> <span class="k">extends</span> <span class="nx">BaseApplication</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">console</span><span class="p">(</span><span class="nv">$commands</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Add by classname</span>
        <span class="nv">$commands</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nx">UserShell</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

        <span class="c1">// Add instance</span>
        <span class="nv">$commands</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">VersionShell</span><span class="p">());</span>

        <span class="k">return</span> <span class="nv">$commands</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, the only commands available would be <code class="docutils literal"><span class="pre">help</span></code>, <code class="docutils literal"><span class="pre">version</span></code>
and <code class="docutils literal"><span class="pre">user</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.5.0: </span>The <code class="docutils literal"><span class="pre">console</span></code> hook was added.</p>
</div>
</div>
<div class="section" id="routing-in-shells-cli">
<h2>Routing in Shells / CLI<a class="headerlink" href="#routing-in-shells-cli" title="Permalink to this headline">¶</a></h2>
<p>In command-line interface (CLI), specifically your shells and tasks,
<code class="docutils literal"><span class="pre">env('HTTP_HOST')</span></code> and other webbrowser specific environment variables are not
set.</p>
<p>If you generate reports or send emails that make use of <code class="docutils literal"><span class="pre">Router::url()</span></code> those
will contain the default host <code class="docutils literal"><span class="pre">http://localhost/</span></code>  and thus resulting in
invalid URLs. In this case you need to specify the domain manually.
You can do that using the Configure value <code class="docutils literal"><span class="pre">App.fullBaseUrl</span></code> from your
bootstrap or config, for example.</p>
<p>For sending emails, you should provide Email class with the host you want to
send the email with:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\Mailer\Email</span><span class="p">;</span>

<span class="nv">$email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Email</span><span class="p">();</span>
<span class="c1">// Prior to 3.4 use domain()</span>
<span class="nv">$email</span><span class="o">-&gt;</span><span class="na">setDomain</span><span class="p">(</span><span class="s1">&#39;www.example.org&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>This asserts that the generated message IDs are valid and fit to the domain the
emails are sent from.</p>
</div>
<div class="section" id="more-topics">
<h2>More Topics<a class="headerlink" href="#more-topics" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/helpers.html">Shell Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/repl.html">Interactive Console (REPL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/cron-jobs.html">Running Shells as Cron Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/i18n-shell.html">I18N Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/completion-shell.html">Completion Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/plugin-shell.html">Plugin Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/routes-shell.html">Routes Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/upgrade-shell.html">Upgrade Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/server-shell.html">Server Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/cache.html">Cache Shell</a></li>
</ul>
</div>
</div>
</div>


            </div>
        </div>

        
        <div class="col-md-3 col-md-pull-9 hidden-xs hidden-sm" lang="en">
            <aside class="sidebar">
                <div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<p class="caption"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">CakePHP at a Glance</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices/3-x-migration-guide.html">3.x Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/request-response.html">Request &amp; Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="orm.html">Database Access &amp; ORM</a></li>
</ul>
<p class="caption"><span class="caption-text">Using CakePHP</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="controllers/components/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="bake.html">Bake Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/caching.html">Caching</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Console Tools, Shells &amp; Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/helpers.html">Shell Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/repl.html">Interactive Console (REPL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/cron-jobs.html">Running Shells as Cron Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/i18n-shell.html">I18N Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/completion-shell.html">Completion Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/plugin-shell.html">Plugin Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/routes-shell.html">Routes Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/upgrade-shell.html">Upgrade Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/server-shell.html">Server Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/cache.html">Cache Shell</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/errors.html">Error &amp; Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/events.html">Events System</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/internationalization-and-localization.html">Internationalization &amp; Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/form.html">Modelless Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/components/pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/rest.html">REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/sessions.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/validation.html">Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/app.html">App Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/file-folder.html">Folder &amp; File</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/hash.html">Hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/httpclient.html">Http Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/inflector.html">Inflector</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/registry-objects.html">Registry Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/time.html">Date &amp; Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/xml.html">Xml</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chronos.html">Chronos</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug-kit.html">Debug Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="elasticsearch.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade-tool.html">Upgrade Tool</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/global-constants-and-functions.html">Constants &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>

</div>

                </div>
            </aside>
            <aside class="sidebar">
                <div class="mb30 row">
                </div>
            </aside>
        </div>
    </div>
</div>

<section id="socials" class="back-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-5  social text-center">
                <div class="col-sm-3 col-xs-3">
                    <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                          var js, fjs = d.getElementsByTagName(s)[0];
                          if (d.getElementById(id)) return;
                          js = d.createElement(s); js.id = id;
                          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
                          fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));
                        </script>
                        <div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-7 social-footer text-center ">
                <a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
                <a href="https://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
                <a href="https://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
                <a href="https://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
                <a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
                <a href="https://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
                <a href="https://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
                <a href="https://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
            </div>
        </div>
    </div>
</section>

<footer id="footer" class="footer-wrapper">
    <div class="container">

        <div class="row col-p30">
            <div class="col-sm-12 col-md-3">
                <div class="footer-widget t-footer">
                    <div class="col-md-12">
                        <a href="https://www.openhub.net/p/cakephp">
                            <img src="_static/open-hub.png">
                        </a>
                        <div class="mt10">
                            <a href="https://www.rackspace.com/">
                                <img src="_static/rackspace.png">
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12 col-md-9">
                <div class="col-md-3 col-sm-6 business-solution">
                    <ul class="footer-menu">
                        <li class="menu-title">
    <a href="https://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
    <a href="https://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center mt30">
                <p class="copyright">
                            &copy; Copyright 2017, Cake Software Foundation, Inc.
                        Last updated on Aug 30, 2017.
                        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
                </p>
            </div>
        </div>
    </div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-743287-3']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
  </body>
</html>