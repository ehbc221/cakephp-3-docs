

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Getting Started" lang="en" name="title" />
<meta content="folder structure,table names,initial request,database table,organizational structure,rst,filenames,conventions,mvc,web page,sit" lang="en" name="keywords" />

    <title>Quick Start Guide - 3.x</title>
    <link href="_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="_static/app.js"></script>

    <link rel="alternate" hreflang="pt_BR" href="../pt/quickstart.html" /><link rel="alternate" hreflang="es" href="../es/quickstart.html" /><link rel="alternate" hreflang="ja" href="../ja/quickstart.html" /><link rel="alternate" hreflang="fr" href="../fr/quickstart.html" /><link rel="alternate" hreflang="zh" href="../zh/quickstart.html" /><link rel="alternate" hreflang="tr" href="../tr/quickstart.html" /><link rel="alternate" hreflang="ru" href="../ru/quickstart.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 3.5 documentation" href="_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 3.5 documentation" href="index.html" />
    <link rel="next" title="3.x Migration Guide" href="appendices/3-x-migration-guide.html" />
    <link rel="prev" title="CakePHP Folder Structure" href="intro/cakephp-folder-structure.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
    
    <header class="nav-down">
        <div class="container-fluid hidden-xs hidden-sm">
            <div class="row">
                <div class="col-sm-3 col-md-3">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-9 col-md-9">
                    <nav class="navbar-right">
                        <ul class="menu">
                            <li class="first">
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
                                <ul class="submenu">
                                    
<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                                </ul>
                            </li>

                            <li><a href="https://cakephp.org/business-solutions">Business Solutions</a></li>
                            <li><a href="https://cakephp.org/writers">Get Paid To Write</a></li>
                            <li><a href="https://cakephp.org/pages/team">Team</a></li>

                            <li>
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
                                <div class="megamenu full">
                                    <div class="row">
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

        
        <div class="container-fluid hidden-md hidden-lg">
            <div class="row">
                <div class="col-sm-6 col-xs-6">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-6 col-xs-6">
                    <div class="navbar-right">
                        <button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
                            <i class="fa fa-bars toggle-modal"></i>
                        </button>
                    </div>
                    <div id="wrap">
                        <form class="search" action="search.html" method="get">
                            <input name="q" type="search" placeholder="What are you looking for?">
                            <input id="search_submit" value="Search" type="submit">
                        </form>
                    </div>
                </div>
            </div>
        </div>

        
        <section id="nav-cook" class="hidden-xs hidden-sm">
            <div class="container-fluid ">
                <div class="row ">
                    <div class="col-md-12 back-book">
                        <div class="col-md-5 text-center t-cook-nav p0 hidden-sm hidden-xs">
                            <h2>
                                <a href="contents.html">
                                    <span class="glyph_range icon-submenu icon-submenu-cook">B</span>
                                    CakePHP 3.5 Red Velvet <strong>Cookbook</strong>
                                </a>
                            </h2>
                        </div>

                        <div class="col-md-4 hidden-sm">
                            <form class="search" action="search.html" method="get">
                                <input type="hidden" name="check_keywords" value="yes" />
                                <input type="hidden" name="area" value="default" />

                                <div class="col-md-10 p0">
                                    <input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
                                </div>
                                <div class="col-md-2 p0 search-cook">
                                    <button type="submit">
                                        <span class="glyph_range icon-submenu icon-submenu-cook">A</span>
                                    </button>
                                </div>
                            </form>
                        </div>

                        
                        <div class="col-md-3">
                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Language:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
                                                    role="button" aria-haspopup="true" aria-expanded="false" href="#">
                                                        en
                                                        <i class="fa fa-menu-en fa-chevron-down"></i>
                                                    </a>
                                            <ul class="dropdown-menu">
                                            
                                                <li></li>
                                            
                                                <li><a href="../pt/quickstart.html">pt</a></li>
                                            
                                                <li><a href="../es/quickstart.html">es</a></li>
                                            
                                                <li><a href="../ja/quickstart.html">ja</a></li>
                                            
                                                <li><a href="../fr/quickstart.html">fr</a></li>
                                            
                                                <li><a href="../zh/quickstart.html">zh</a></li>
                                            
                                                <li><a href="../tr/quickstart.html">tr</a></li>
                                            
                                                <li><a href="../ru/quickstart.html">ru</a></li>
                                            
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Version:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">3.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="https://book.cakephp.org/3.0/en">3.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/2.0/en">2.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.3/en/">1.3 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.2/en/">1.2 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.1/en">1.1 Book</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </section>
    </header>

    
    <section class="nav-btn visible-sm visible-xs">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
                </div>

                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
                </div>
            </div>
        </div>
    </section>

    
    <div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title-cookbook" id="modal-header"></h4>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>

<div class="container page-container "><div id="improve-slideout">
        <i class="fa fa-pencil icon-improve"></i>
        <a href="https://github.com/cakephp/docs/edit/3.0/en/quickstart.rst" target="_blank">
            <div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
        </a>
    </div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

    
    <div class="row">
        <div class="col-sm-12 col-md-9 col-md-push-3"><div class="page-contents col-sm-5">
                <h3>Page Contents</h3>
                <ul>
<li><a class="reference internal" href="#">Quick Start Guide</a><ul>
<li><a class="reference internal" href="#bookmarker-tutorial">Bookmarker Tutorial</a><ul>
<li><a class="reference internal" href="#getting-cakephp">Getting CakePHP</a></li>
<li><a class="reference internal" href="#checking-our-installation">Checking our Installation</a></li>
<li><a class="reference internal" href="#creating-the-database">Creating the Database</a></li>
<li><a class="reference internal" href="#database-configuration">Database Configuration</a></li>
<li><a class="reference internal" href="#generating-scaffold-code">Generating Scaffold Code</a></li>
<li><a class="reference internal" href="#adding-password-hashing">Adding Password Hashing</a></li>
<li><a class="reference internal" href="#getting-bookmarks-with-a-specific-tag">Getting Bookmarks with a Specific Tag</a><ul>
<li><a class="reference internal" href="#creating-the-finder-method">Creating the Finder Method</a></li>
<li><a class="reference internal" href="#creating-the-view">Creating the View</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#bookmarker-tutorial-part-2">Bookmarker Tutorial Part 2</a><ul>
<li><a class="reference internal" href="#adding-login">Adding Login</a></li>
<li><a class="reference internal" href="#adding-logout">Adding Logout</a></li>
<li><a class="reference internal" href="#enabling-registrations">Enabling Registrations</a></li>
<li><a class="reference internal" href="#restricting-bookmark-access">Restricting Bookmark Access</a></li>
<li><a class="reference internal" href="#fixing-list-view-and-forms">Fixing List view and Forms</a><ul>
<li><a class="reference internal" href="#list-view">List View</a></li>
</ul>
</li>
<li><a class="reference internal" href="#improving-the-tagging-experience">Improving the Tagging Experience</a><ul>
<li><a class="reference internal" href="#adding-a-computed-field">Adding a Computed Field</a></li>
<li><a class="reference internal" href="#updating-the-views">Updating the Views</a></li>
<li><a class="reference internal" href="#persisting-the-tag-string">Persisting the Tag String</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wrapping-up">Wrapping Up</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div><div class="document-body">
            
  <div class="section" id="quick-start-guide">
<h1>Quick Start Guide<a class="headerlink" href="#quick-start-guide" title="Permalink to this headline">¶</a></h1>
<p>The best way to experience and learn CakePHP is to sit down and build something.
To start off we&#8217;ll build a simple bookmarking application.</p>
<div class="section" id="bookmarker-tutorial">
<h2>Bookmarker Tutorial<a class="headerlink" href="#bookmarker-tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will walk you through the creation of a simple bookmarking
application (bookmarker). To start with, we&#8217;ll be installing CakePHP, creating
our database, and using the tools CakePHP provides to get our application up
fast.</p>
<p>Here&#8217;s what you&#8217;ll need:</p>
<ol class="arabic simple">
<li>A database server. We&#8217;re going to be using MySQL server in this tutorial.
You&#8217;ll need to know enough about SQL in order to create a database: CakePHP
will be taking the reins from there. Since we&#8217;re using MySQL, also make sure
that you have <code class="docutils literal"><span class="pre">pdo_mysql</span></code> enabled in PHP.</li>
<li>Basic PHP knowledge.</li>
</ol>
<p>Before starting you should make sure that you have got an up to date PHP
version:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>php -v
</pre></div>
</div>
<p>You should at least have got installed PHP 5.6.0 (CLI) or higher.
Your webserver&#8217;s PHP version must also be of 5.6.0 or higher, and should best be
the same version your command line interface (CLI) PHP version is of.
If you&#8217;d like to see the completed application, checkout <a class="reference external" href="https://github.com/cakephp/bookmarker-tutorial">cakephp/bookmarker</a>. Let&#8217;s get started!</p>
<div class="section" id="getting-cakephp">
<h3>Getting CakePHP<a class="headerlink" href="#getting-cakephp" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to install CakePHP is to use Composer.  Composer is a simple way
of installing CakePHP from your terminal or command line prompt.  First, you&#8217;ll
need to download and install Composer if you haven&#8217;t done so already. If you
have cURL installed, it&#8217;s as easy as running the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">curl</span> <span class="o">-</span><span class="nx">s</span> <span class="nx">https</span><span class="o">://</span><span class="nx">getcomposer</span><span class="o">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">installer</span> <span class="o">|</span> <span class="nx">php</span>
</pre></div>
</div>
<p>Or, you can download <code class="docutils literal"><span class="pre">composer.phar</span></code> from the
<a class="reference external" href="https://getcomposer.org/download/">Composer website</a>.</p>
<p>Then simply type the following line in your terminal from your
installation directory to install the CakePHP application skeleton
in the <strong>bookmarker</strong> directory:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">php</span> <span class="nx">composer</span><span class="o">.</span><span class="nx">phar</span> <span class="nx">create</span><span class="o">-</span><span class="nx">project</span> <span class="o">--</span><span class="nx">prefer</span><span class="o">-</span><span class="nx">dist</span> <span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span> <span class="nx">bookmarker</span>
</pre></div>
</div>
<p>If you downloaded and ran the <a class="reference external" href="https://getcomposer.org/Composer-Setup.exe">Composer Windows Installer</a>, then type the following line in
your terminal from your installation directory (ie.
C:\wamp\www\dev\cakephp3):</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">composer</span> <span class="nx">self</span><span class="o">-</span><span class="nx">update</span> <span class="o">&amp;&amp;</span> <span class="nx">composer</span> <span class="nx">create</span><span class="o">-</span><span class="nx">project</span> <span class="o">--</span><span class="nx">prefer</span><span class="o">-</span><span class="nx">dist</span> <span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span> <span class="nx">bookmarker</span>
</pre></div>
</div>
<p>The advantage to using Composer is that it will automatically complete some
important set up tasks, such as setting the correct file permissions and
creating your <strong>config/app.php</strong> file for you.</p>
<p>There are other ways to install CakePHP. If you cannot or don&#8217;t want to use
Composer, check out the <a class="reference internal" href="installation.html"><span class="doc">Installation</span></a> section.</p>
<p>Regardless of how you downloaded and installed CakePHP, once your set up is
completed, your directory setup should look something like the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nx">bookmarker</span>
    <span class="o">/</span><span class="nx">bin</span>
    <span class="o">/</span><span class="nx">config</span>
    <span class="o">/</span><span class="nx">logs</span>
    <span class="o">/</span><span class="nx">plugins</span>
    <span class="o">/</span><span class="nx">src</span>
    <span class="o">/</span><span class="nx">tests</span>
    <span class="o">/</span><span class="nx">tmp</span>
    <span class="o">/</span><span class="nx">vendor</span>
    <span class="o">/</span><span class="nx">webroot</span>
    <span class="o">.</span><span class="nx">editorconfig</span>
    <span class="o">.</span><span class="nx">gitignore</span>
    <span class="o">.</span><span class="nx">htaccess</span>
    <span class="o">.</span><span class="nx">travis</span><span class="o">.</span><span class="nx">yml</span>
    <span class="nx">composer</span><span class="o">.</span><span class="nx">json</span>
    <span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
    <span class="nx">phpunit</span><span class="o">.</span><span class="nx">xml</span><span class="o">.</span><span class="nx">dist</span>
    <span class="nx">README</span><span class="o">.</span><span class="nx">md</span>
</pre></div>
</div>
<p>Now might be a good time to learn a bit about how CakePHP&#8217;s directory structure
works: check out the <a class="reference internal" href="intro/cakephp-folder-structure.html"><span class="doc">CakePHP Folder Structure</span></a> section.</p>
</div>
<div class="section" id="checking-our-installation">
<h3>Checking our Installation<a class="headerlink" href="#checking-our-installation" title="Permalink to this headline">¶</a></h3>
<p>We can quickly check that our installation is correct, by checking the default
home page. Before you can do that, you&#8217;ll need to start the development server:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">server</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For Windows, the command needs to be <code class="docutils literal"><span class="pre">bin\cake</span> <span class="pre">server</span></code> (note the backslash).</p>
</div>
<p>This will start PHP&#8217;s built-in webserver on port 8765. Open up
<strong>http://localhost:8765</strong> in your web browser to see the welcome page. All the
bullet points should be checkmarks other than CakePHP being able to connect to
your database. If not, you may need to install additional PHP extensions, or set
directory permissions.</p>
</div>
<div class="section" id="creating-the-database">
<h3>Creating the Database<a class="headerlink" href="#creating-the-database" title="Permalink to this headline">¶</a></h3>
<p>Next, let&#8217;s set up the database for our bookmarking application. If you
haven&#8217;t already done so, create an empty database for use in this
tutorial, with a name of your choice, e.g. <code class="docutils literal"><span class="pre">cake_bookmarks</span></code>. You can execute
the following SQL to create the necessary tables:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">users</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">INT</span> <span class="nx">AUTO_INCREMENT</span> <span class="nx">PRIMARY</span> <span class="nx">KEY</span><span class="p">,</span>
    <span class="nx">email</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">password</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">created</span> <span class="nx">DATETIME</span><span class="p">,</span>
    <span class="nx">modified</span> <span class="nx">DATETIME</span>
<span class="p">);</span>

<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">bookmarks</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">INT</span> <span class="nx">AUTO_INCREMENT</span> <span class="nx">PRIMARY</span> <span class="nx">KEY</span><span class="p">,</span>
    <span class="nx">user_id</span> <span class="nx">INT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">title</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="nx">description</span> <span class="nx">TEXT</span><span class="p">,</span>
    <span class="nx">url</span> <span class="nx">TEXT</span><span class="p">,</span>
    <span class="nx">created</span> <span class="nx">DATETIME</span><span class="p">,</span>
    <span class="nx">modified</span> <span class="nx">DATETIME</span><span class="p">,</span>
    <span class="nx">FOREIGN</span> <span class="nx">KEY</span> <span class="nx">user_key</span> <span class="p">(</span><span class="nx">user_id</span><span class="p">)</span> <span class="nx">REFERENCES</span> <span class="nx">users</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">tags</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">INT</span> <span class="nx">AUTO_INCREMENT</span> <span class="nx">PRIMARY</span> <span class="nx">KEY</span><span class="p">,</span>
    <span class="nx">title</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
    <span class="nx">created</span> <span class="nx">DATETIME</span><span class="p">,</span>
    <span class="nx">modified</span> <span class="nx">DATETIME</span><span class="p">,</span>
    <span class="nx">UNIQUE</span> <span class="nx">KEY</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span>
<span class="p">);</span>

<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">bookmarks_tags</span> <span class="p">(</span>
    <span class="nx">bookmark_id</span> <span class="nx">INT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">tag_id</span> <span class="nx">INT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">PRIMARY</span> <span class="nx">KEY</span> <span class="p">(</span><span class="nx">bookmark_id</span><span class="p">,</span> <span class="nx">tag_id</span><span class="p">),</span>
    <span class="nx">FOREIGN</span> <span class="nx">KEY</span> <span class="nx">tag_key</span><span class="p">(</span><span class="nx">tag_id</span><span class="p">)</span> <span class="nx">REFERENCES</span> <span class="nx">tags</span><span class="p">(</span><span class="nx">id</span><span class="p">),</span>
    <span class="nx">FOREIGN</span> <span class="nx">KEY</span> <span class="nx">bookmark_key</span><span class="p">(</span><span class="nx">bookmark_id</span><span class="p">)</span> <span class="nx">REFERENCES</span> <span class="nx">bookmarks</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>You may have noticed that the <code class="docutils literal"><span class="pre">bookmarks_tags</span></code> table used a composite primary
key. CakePHP supports composite primary keys almost everywhere, making it easier
to build multi-tenanted applications.</p>
<p>The table and column names we used were not arbitrary. By using CakePHP&#8217;s
<a class="reference internal" href="intro/conventions.html"><span class="doc">naming conventions</span></a>, we can leverage CakePHP better
and avoid having to configure the framework. CakePHP is flexible enough to
accommodate even inconsistent legacy database schemas, but adhering to the
conventions will save you time.</p>
</div>
<div class="section" id="database-configuration">
<h3>Database Configuration<a class="headerlink" href="#database-configuration" title="Permalink to this headline">¶</a></h3>
<p>Next, let&#8217;s tell CakePHP where our database is and how to connect to it.
For many, this will be the first and last time you will need to configure
anything.</p>
<p>The configuration should be pretty straightforward: just replace the
values in the <code class="docutils literal"><span class="pre">Datasources.default</span></code> array in the <strong>config/app.php</strong> file
with those that apply to your setup. A sample completed configuration
array might look something like the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="p">[</span>
    <span class="c1">// More configuration above.</span>
    <span class="s1">&#39;Datasources&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;className&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Cake\Database\Connection&#39;</span><span class="p">,</span>
            <span class="s1">&#39;driver&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Cake\Database\Driver\Mysql&#39;</span><span class="p">,</span>
            <span class="s1">&#39;persistent&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
            <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
            <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cakephp&#39;</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AngelF00dC4k3~&#39;</span><span class="p">,</span>
            <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cake_bookmarks&#39;</span><span class="p">,</span>
            <span class="s1">&#39;encoding&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
            <span class="s1">&#39;timezone&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;UTC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cacheMetadata&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">],</span>
    <span class="c1">// More configuration below.</span>
<span class="p">];</span>
</pre></div>
</div>
<p>Once you&#8217;ve saved your <strong>config/app.php</strong> file, you should see that &#8216;CakePHP is
able to connect to the database&#8217; section have a checkmark.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A copy of CakePHP&#8217;s default configuration file is found in
<strong>config/app.default.php</strong>.</p>
</div>
</div>
<div class="section" id="generating-scaffold-code">
<h3>Generating Scaffold Code<a class="headerlink" href="#generating-scaffold-code" title="Permalink to this headline">¶</a></h3>
<p>Because our database is following the CakePHP conventions, we can use the
<a class="reference internal" href="bake/usage.html"><span class="doc">bake console</span></a> application to quickly generate a basic
application. In your command line run the following commands:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// On Windows you&#39;ll need to use bin\cake instead.</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">all</span> <span class="nx">users</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">all</span> <span class="nx">bookmarks</span>
<span class="nx">bin</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">all</span> <span class="nx">tags</span>
</pre></div>
</div>
<p>This will generate the controllers, models, views, their corresponding test
cases, and fixtures for our users, bookmarks and tags resources. If you&#8217;ve
stopped your server, restart it and go to <strong>http://localhost:8765/bookmarks</strong>.</p>
<p>You should see a basic but functional application providing data access to your
application&#8217;s database tables. Once you&#8217;re at the list of bookmarks, add a few
users, bookmarks, and tags.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you see a Not Found (404) page, confirm that the Apache mod_rewrite
module is loaded.</p>
</div>
</div>
<div class="section" id="adding-password-hashing">
<h3>Adding Password Hashing<a class="headerlink" href="#adding-password-hashing" title="Permalink to this headline">¶</a></h3>
<p>When you created your users (by visiting
<strong>http://localhost:8765/users</strong>), you probably noticed that the
passwords were stored in plain text. This is pretty bad from a security point of
view, so let&#8217;s get that fixed.</p>
<p>This is also a good time to talk about the model layer in CakePHP. In CakePHP,
we separate the methods that operate on a collection of objects, and a single
object into different classes. Methods that operate on the collection of
entities are put in the <code class="docutils literal"><span class="pre">Table</span></code> class, while features belonging to a single
record are put on the <code class="docutils literal"><span class="pre">Entity</span></code> class.</p>
<p>For example, password hashing is done on the individual record, so we&#8217;ll
implement this behavior on the entity object. Because, we want to hash the
password each time it is set, we&#8217;ll use a mutator/setter method. CakePHP will
call convention based setter methods any time a property is set in one of your
entities. Let&#8217;s add a setter for the password. In <strong>src/Model/Entity/User.php</strong>
add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Auth\DefaultPasswordHasher</span><span class="p">;</span> <span class="c1">//include this line</span>
<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>

    <span class="c1">// Code from bake.</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_setPassword</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$hasher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DefaultPasswordHasher</span><span class="p">();</span>
        <span class="k">return</span> <span class="nv">$hasher</span><span class="o">-&gt;</span><span class="na">hash</span><span class="p">(</span><span class="nv">$value</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now update one of the users you created earlier, if you change their password,
you should see a hashed password instead of the original value on the list or
view pages. CakePHP hashes passwords with <a class="reference external" href="http://codahale.com/how-to-safely-store-a-password/">bcrypt</a> by default. You can also
use sha1 or md5 if you&#8217;re working with an existing database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the password doesn&#8217;t get hashed, make sure you followed the same case for the password member of the class while naming the setter function</p>
</div>
</div>
<div class="section" id="getting-bookmarks-with-a-specific-tag">
<h3>Getting Bookmarks with a Specific Tag<a class="headerlink" href="#getting-bookmarks-with-a-specific-tag" title="Permalink to this headline">¶</a></h3>
<p>Now that we&#8217;re storing passwords safely, we can build out some more interesting
features in our application. Once you&#8217;ve amassed a collection of bookmarks, it
is helpful to be able to search through them by tag. Next we&#8217;ll implement
a route, controller action, and finder method to search through bookmarks by
tag.</p>
<p>Ideally, we&#8217;d have a URL that looks like
<strong>http://localhost:8765/bookmarks/tagged/funny/cat/gifs</strong>. This would let us
find all the bookmarks that have the &#8216;funny&#8217;, &#8216;cat&#8217; or &#8216;gifs&#8217; tags. Before we
can implement this, we&#8217;ll add a new route. Your <strong>config/routes.php</strong> should
look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">use</span> <span class="nx">Cake\Routing\Route\DashedRoute</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Cake\Routing\Router</span><span class="p">;</span>

<span class="nx">Router</span><span class="o">::</span><span class="na">defaultRouteClass</span><span class="p">(</span><span class="nx">DashedRoute</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

<span class="c1">// New route we&#39;re adding for our tagged action.</span>
<span class="c1">// The trailing `*` tells CakePHP that this action has</span>
<span class="c1">// passed parameters.</span>
<span class="nx">Router</span><span class="o">::</span><span class="na">scope</span><span class="p">(</span>
    <span class="s1">&#39;/bookmarks&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bookmarks&#39;</span><span class="p">],</span>
    <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/tagged/*&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;tags&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">);</span>

<span class="nx">Router</span><span class="o">::</span><span class="na">scope</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$routes</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Connect the default home and /pages/* routes.</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Pages&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;display&#39;</span><span class="p">,</span> <span class="s1">&#39;home&#39;</span>
    <span class="p">]);</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/pages/*&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Pages&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;display&#39;</span>
    <span class="p">]);</span>

    <span class="c1">// Connect the conventions based default routes.</span>
    <span class="nv">$routes</span><span class="o">-&gt;</span><span class="na">fallbacks</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The above defines a new &#8216;route&#8217; which connects the <strong>/bookmarks/tagged/</strong> path,
to <code class="docutils literal"><span class="pre">BookmarksController::tags()</span></code>. By defining routes, you can isolate how your
URLs look, from how they are implemented. If we were to visit
<strong>http://localhost:8765/bookmarks/tagged</strong>, we would see a helpful error page
from CakePHP informing you that the controller action does not exist. Let&#8217;s
implement that missing method now. In <strong>src/Controller/BookmarksController.php</strong>
add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">tags</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// The &#39;pass&#39; key is provided by CakePHP and contains all</span>
    <span class="c1">// the passed URL path segments in the request.</span>
    <span class="nv">$tags</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>

    <span class="c1">// Use the BookmarksTable to find tagged bookmarks.</span>
    <span class="nv">$bookmarks</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;tagged&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;tags&#39;</span> <span class="o">=&gt;</span> <span class="nv">$tags</span>
    <span class="p">]);</span>

    <span class="c1">// Pass variables into the view template context.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">([</span>
        <span class="s1">&#39;bookmarks&#39;</span> <span class="o">=&gt;</span> <span class="nv">$bookmarks</span><span class="p">,</span>
        <span class="s1">&#39;tags&#39;</span> <span class="o">=&gt;</span> <span class="nv">$tags</span>
    <span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To access other parts of the request data, consult the <a class="reference internal" href="controllers/request-response.html#cake-request"><span class="std std-ref">Request</span></a>
section.</p>
<div class="section" id="creating-the-finder-method">
<h4>Creating the Finder Method<a class="headerlink" href="#creating-the-finder-method" title="Permalink to this headline">¶</a></h4>
<p>In CakePHP we like to keep our controller actions slim, and put most of our
application&#8217;s logic in the models. If you were to visit the
<strong>/bookmarks/tagged</strong> URL now you would see an error that the <code class="docutils literal"><span class="pre">findTagged()</span></code>
method has not been implemented yet, so let&#8217;s do that. In
<strong>src/Model/Table/BookmarksTable.php</strong> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// The $query argument is a query builder instance.</span>
<span class="c1">// The $options array will contain the &#39;tags&#39; option we passed</span>
<span class="c1">// to find(&#39;tagged&#39;) in our controller action.</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">findTagged</span><span class="p">(</span><span class="nx">Query</span> <span class="nv">$query</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$bookmarks</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">select</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]);</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$bookmarks</span>
            <span class="o">-&gt;</span><span class="na">leftJoinWith</span><span class="p">(</span><span class="s1">&#39;Tags&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">where</span><span class="p">([</span><span class="s1">&#39;Tags.title IS&#39;</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$bookmarks</span>
            <span class="o">-&gt;</span><span class="na">innerJoinWith</span><span class="p">(</span><span class="s1">&#39;Tags&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">where</span><span class="p">([</span><span class="s1">&#39;Tags.title IN &#39;</span> <span class="o">=&gt;</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]]);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$bookmarks</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">([</span><span class="s1">&#39;Bookmarks.id&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We just implemented a <a class="reference internal" href="orm/retrieving-data-and-resultsets.html#custom-find-methods"><span class="std std-ref">custom finder method</span></a>. This is
a very powerful concept in CakePHP that allows you to package up re-usable
queries. Finder methods always get a <a class="reference internal" href="orm/query-builder.html"><span class="doc">Query Builder</span></a> object and an
array of options as parameters. Finders can manipulate the query and add any
required conditions or criteria. When complete, finder methods must return
a modified query object. In our finder we&#8217;ve leveraged the <code class="docutils literal"><span class="pre">innerJoinWith()</span></code>,
<code class="docutils literal"><span class="pre">where()</span></code> and <code class="docutils literal"><span class="pre">group()</span></code> methods which allow us to find distinct bookmarks
that have a matching tag.  When no tags are provided we use a
<code class="docutils literal"><span class="pre">leftJoinWith()</span></code> and modify the &#8216;where&#8217; condition, finding bookmarks without
tags.</p>
</div>
<div class="section" id="creating-the-view">
<h4>Creating the View<a class="headerlink" href="#creating-the-view" title="Permalink to this headline">¶</a></h4>
<p>Now if you visit the <strong>/bookmarks/tagged</strong> URL, CakePHP will show an error
letting you know that you have not made a view file. Next, let&#8217;s build the
view file for our <code class="docutils literal"><span class="pre">tags()</span></code> action. In <strong>src/Template/Bookmarks/tags.ctp</strong>
put the following content:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span>
    <span class="nx">Bookmarks</span> <span class="nx">tagged</span> <span class="nx">with</span>
    <span class="o">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Text</span><span class="o">-&gt;</span><span class="na">toList</span><span class="p">(</span><span class="nx">h</span><span class="p">(</span><span class="nv">$tags</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/h1&gt;</span>

<span class="x">&lt;section&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$bookmarks</span> <span class="k">as</span> <span class="nv">$bookmark</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;article&gt;</span>
<span class="x">        &lt;!-- Use the HtmlHelper to create a link --&gt;</span>
<span class="x">        &lt;h4&gt;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">,</span> <span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&lt;/h4&gt;</span>
<span class="x">        &lt;small&gt;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&lt;/small&gt;</span>

<span class="x">        &lt;!-- Use the TextHelper to format text --&gt;</span>
<span class="x">        </span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Text</span><span class="o">-&gt;</span><span class="na">autoParagraph</span><span class="p">(</span><span class="nx">h</span><span class="p">(</span><span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;/article&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/section&gt;</span>
</pre></div>
</div>
<p>In the above code we use the <a class="reference internal" href="views/helpers/html.html"><span class="doc">Html</span></a> and
<a class="reference internal" href="views/helpers/text.html"><span class="doc">Text</span></a> helpers to assist in generating our view output. We
also use the <a class="reference internal" href="core-libraries/global-constants-and-functions.html#h" title="h"><code class="xref php php-func docutils literal"><span class="pre">h</span></code></a> shortcut function to HTML encode output. You should
remember to always use <code class="docutils literal"><span class="pre">h()</span></code> when outputting user data to prevent HTML
injection issues.</p>
<p>The <strong>tags.ctp</strong> file we just created follows the CakePHP conventions for view
template files. The convention is to have the template use the lower case and
underscored version of the controller action name.</p>
<p>You may notice that we were able to use the <code class="docutils literal"><span class="pre">$tags</span></code> and <code class="docutils literal"><span class="pre">$bookmarks</span></code>
variables in our view. When we use the <code class="docutils literal"><span class="pre">set()</span></code> method in our controller, we
set specific variables to be sent to the view. The view will make all passed
variables available in the templates as local variables.</p>
<p>You should now be able to visit the <strong>/bookmarks/tagged/funny</strong> URL and see all
the bookmarks tagged with &#8216;funny&#8217;.</p>
<p>So far, we&#8217;ve created a basic application to manage bookmarks, tags and users.
However, everyone can see everyone else&#8217;s tags. In the next chapter, we&#8217;ll
implement authentication and restrict the visible bookmarks to only those that
belong to the current user.</p>
<p>Now continue to <a class="reference internal" href="tutorials-and-examples/bookmarks/part-two.html"><span class="doc">Bookmarker Tutorial Part 2</span></a> to
continue building your application or <a class="reference internal" href="topics.html"><span class="doc">dive into the documentation</span></a> to learn more about what CakePHP can do for you.</p>
</div>
</div>
</div>
<div class="section" id="bookmarker-tutorial-part-2">
<h2>Bookmarker Tutorial Part 2<a class="headerlink" href="#bookmarker-tutorial-part-2" title="Permalink to this headline">¶</a></h2>
<p>After finishing <a class="reference internal" href="tutorials-and-examples/bookmarks/intro.html"><span class="doc">the first part of this tutorial</span></a> you should have a very basic
bookmarking application. In this chapter we&#8217;ll be adding authentication and
restricting the bookmarks each user can see/modify to only the ones they own.</p>
<div class="section" id="adding-login">
<h3>Adding Login<a class="headerlink" href="#adding-login" title="Permalink to this headline">¶</a></h3>
<p>In CakePHP, authentication is handled by <a class="reference internal" href="controllers/components.html"><span class="doc">Components</span></a>.
Components can be thought of as ways to create reusable chunks of controller
code related to a specific feature or concept. Components can also hook into the
controller&#8217;s event life-cycle and interact with your application that way. To
get started, we&#8217;ll add the <a class="reference internal" href="controllers/components/authentication.html"><span class="doc">AuthComponent</span></a> to our application. We&#8217;ll pretty much
want every method to require authentication, so we&#8217;ll add AuthComponent in our
AppController:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// In src/Controller/AppController.php</span>
<span class="k">namespace</span> <span class="nx">App\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\Controller\Controller</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AppController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadComponent</span><span class="p">(</span><span class="s1">&#39;Flash&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadComponent</span><span class="p">(</span><span class="s1">&#39;Auth&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                    <span class="s1">&#39;fields&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                        <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span>
                    <span class="p">]</span>
                <span class="p">]</span>
            <span class="p">],</span>
            <span class="s1">&#39;loginAction&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Users&#39;</span><span class="p">,</span>
                <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span>
            <span class="p">],</span>
            <span class="s1">&#39;unauthorizedRedirect&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">referer</span><span class="p">()</span> <span class="c1">// If unauthorized, return them to page they were just on</span>
        <span class="p">]);</span>

        <span class="c1">// Allow the display action so our pages controller</span>
        <span class="c1">// continues to work.</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">([</span><span class="s1">&#39;display&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We&#8217;ve just told CakePHP that we want to load the <code class="docutils literal"><span class="pre">Flash</span></code> and <code class="docutils literal"><span class="pre">Auth</span></code>
components. In addition, we&#8217;ve customized the configuration of AuthComponent, as
our users table uses <code class="docutils literal"><span class="pre">email</span></code> as the username. Now, if you go to any URL you&#8217;ll
be kicked to <strong>/users/login</strong>, which will show an error page as we have
not written that code yet. So let&#8217;s create the login action:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// In src/Controller/UsersController.php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">identify</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">setUser</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">redirectUrl</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;Your username or password is incorrect.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And in <strong>src/Template/Users/login.ctp</strong> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Login</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
<span class="o">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">control</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">control</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">button</span><span class="p">(</span><span class="s1">&#39;Login&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">end</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">control()</span></code> method is available since 3.4. For prior versions you can
use the <code class="docutils literal"><span class="pre">input()</span></code> method instead.</p>
</div>
<p>Now that we have a simple login form, we should be able to log in with one of
the users that has a hashed password.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If none of your users have hashed passwords, comment the
<code class="docutils literal"><span class="pre">loadComponent('Auth')</span></code> line. Then go and edit the user,
saving a new password for them.</p>
</div>
</div>
<div class="section" id="adding-logout">
<h3>Adding Logout<a class="headerlink" href="#adding-logout" title="Permalink to this headline">¶</a></h3>
<p>Now that people can log in, you&#8217;ll probably want to provide a way to log out as
well. Again, in the <code class="docutils literal"><span class="pre">UsersController</span></code>, add the following code:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">parent</span><span class="o">::</span><span class="na">initialize</span><span class="p">();</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">([</span><span class="s1">&#39;logout&#39;</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">logout</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">success</span><span class="p">(</span><span class="s1">&#39;You are now logged out.&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">logout</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This code whitelists the <code class="docutils literal"><span class="pre">logout</span></code> action as a public action, and implements
the logout method. Now you can visit <code class="docutils literal"><span class="pre">/users/logout</span></code> to log out. You should
then be sent to the login page.</p>
</div>
<div class="section" id="enabling-registrations">
<h3>Enabling Registrations<a class="headerlink" href="#enabling-registrations" title="Permalink to this headline">¶</a></h3>
<p>If you aren&#8217;t logged in and you try to visit <strong>/users/add</strong> you will be kicked
to the login page. We should fix that as we want to allow people to sign up for
our application. In the <code class="docutils literal"><span class="pre">UsersController</span></code> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">parent</span><span class="o">::</span><span class="na">initialize</span><span class="p">();</span>
    <span class="c1">// Add the &#39;add&#39; action to the allowed actions list.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">([</span><span class="s1">&#39;logout&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above tells <code class="docutils literal"><span class="pre">AuthComponent</span></code> that the <code class="docutils literal"><span class="pre">add()</span></code> action does <em>not</em> require
authentication or authorization. You may want to take the time to clean up the
<strong>Users/add.ctp</strong> and remove the misleading links, or continue on to the next
section. We won&#8217;t be building out user editing, viewing or listing in this
tutorial so they will not work as <code class="docutils literal"><span class="pre">AuthComponent</span></code> will deny you access to those
controller actions.</p>
</div>
<div class="section" id="restricting-bookmark-access">
<h3>Restricting Bookmark Access<a class="headerlink" href="#restricting-bookmark-access" title="Permalink to this headline">¶</a></h3>
<p>Now that users can log in, we&#8217;ll want to limit the bookmarks they can see to the
ones they made. We&#8217;ll do this using an &#8216;authorization&#8217; adapter. Since our
requirements are pretty simple, we can write some simple code in our
<code class="docutils literal"><span class="pre">BookmarksController</span></code>. But before we do that, we&#8217;ll want to tell the
AuthComponent how our application is going to authorize actions. In your
<code class="docutils literal"><span class="pre">AppController</span></code> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">isAuthorized</span><span class="p">(</span><span class="nv">$user</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Also, add the following to the configuration for <code class="docutils literal"><span class="pre">Auth</span></code> in your
<code class="docutils literal"><span class="pre">AppController</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="s1">&#39;authorize&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Controller&#39;</span><span class="p">,</span>
</pre></div>
</div>
<p>Your <code class="docutils literal"><span class="pre">initialize()</span></code> method should now look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadComponent</span><span class="p">(</span><span class="s1">&#39;Flash&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadComponent</span><span class="p">(</span><span class="s1">&#39;Auth&#39;</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;authorize&#39;</span><span class="o">=&gt;</span> <span class="s1">&#39;Controller&#39;</span><span class="p">,</span><span class="c1">//added this line</span>
        <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">&#39;fields&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                    <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;password&#39;</span>
                <span class="p">]</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="s1">&#39;loginAction&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Users&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span>
        <span class="p">],</span>
        <span class="s1">&#39;unauthorizedRedirect&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">referer</span><span class="p">()</span>
    <span class="p">]);</span>

    <span class="c1">// Allow the display action so our pages controller</span>
    <span class="c1">// continues to work.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">([</span><span class="s1">&#39;display&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We&#8217;ll default to denying access, and incrementally grant access where it makes
sense. First, we&#8217;ll add the authorization logic for bookmarks. In your
<code class="docutils literal"><span class="pre">BookmarksController</span></code> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">isAuthorized</span><span class="p">(</span><span class="nv">$user</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$action</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">);</span>

    <span class="c1">// The add and index actions are always allowed.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$action</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// All other actions require an id.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">&#39;pass.0&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Check that the bookmark belongs to the current user.</span>
    <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">&#39;pass.0&#39;</span><span class="p">);</span>
    <span class="nv">$bookmark</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">user_id</span> <span class="o">==</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">parent</span><span class="o">::</span><span class="na">isAuthorized</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now if you try to view, edit or delete a bookmark that does not belong to you,
you should be redirected back to the page you came from. If no error message is
displayed, add the following to your layout:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// In src/Template/Layout/default.ctp</span>
<span class="o">&lt;?=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>You should now see the authorization error messages.</p>
</div>
<div class="section" id="fixing-list-view-and-forms">
<h3>Fixing List view and Forms<a class="headerlink" href="#fixing-list-view-and-forms" title="Permalink to this headline">¶</a></h3>
<p>While view and delete are working, edit, add and index have a few problems:</p>
<ol class="arabic simple">
<li>When adding a bookmark you can choose the user.</li>
<li>When editing a bookmark you can choose the user.</li>
<li>The list page shows bookmarks from other users.</li>
</ol>
<p>Let&#8217;s tackle the add form first. To begin with remove the <code class="docutils literal"><span class="pre">control('user_id')</span></code>
from <strong>src/Template/Bookmarks/add.ctp</strong>. With that removed, we&#8217;ll also update
the <code class="docutils literal"><span class="pre">add()</span></code> action from <strong>src/Controller/BookmarksController.php</strong> to look
like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$bookmark</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">newEntity</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$bookmark</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">patchEntity</span><span class="p">(</span><span class="nv">$bookmark</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">());</span>
        <span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">user_id</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$bookmark</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">success</span><span class="p">(</span><span class="s1">&#39;The bookmark has been saved.&#39;</span><span class="p">);</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">([</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;The bookmark could not be saved. Please, try again.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$tags</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">Tags</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">&#39;bookmark&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">));</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;_serialize&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;bookmark&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By setting the entity property with the session data, we remove any possibility
of the user modifying which user a bookmark is for. We&#8217;ll do the same for the
edit form and action. Your <code class="docutils literal"><span class="pre">edit()</span></code> action from
<strong>src/Controller/BookmarksController.php</strong> should look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$bookmark</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="nv">$id</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">&#39;contain&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;Tags&#39;</span><span class="p">]</span>
    <span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">([</span><span class="s1">&#39;patch&#39;</span><span class="p">,</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="s1">&#39;put&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$bookmark</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">patchEntity</span><span class="p">(</span><span class="nv">$bookmark</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">());</span>
        <span class="nv">$bookmark</span><span class="o">-&gt;</span><span class="na">user_id</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$bookmark</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">success</span><span class="p">(</span><span class="s1">&#39;The bookmark has been saved.&#39;</span><span class="p">);</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">([</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;The bookmark could not be saved. Please, try again.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$tags</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="o">-&gt;</span><span class="na">Tags</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nb">compact</span><span class="p">(</span><span class="s1">&#39;bookmark&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">));</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;_serialize&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;bookmark&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="list-view">
<h4>List View<a class="headerlink" href="#list-view" title="Permalink to this headline">¶</a></h4>
<p>Now, we only need to show bookmarks for the currently logged in user. We can do
that by updating the call to <code class="docutils literal"><span class="pre">paginate()</span></code>. Make your <code class="docutils literal"><span class="pre">index()</span></code> action from
<strong>src/Controller/BookmarksController.php</strong> look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">paginate</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;conditions&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;Bookmarks.user_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">];</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;bookmarks&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Bookmarks</span><span class="p">));</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;_serialize&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;bookmarks&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We should also update the <code class="docutils literal"><span class="pre">tags()</span></code> action and the related finder method, but
we&#8217;ll leave that as an exercise you can complete on your own.</p>
</div>
</div>
<div class="section" id="improving-the-tagging-experience">
<h3>Improving the Tagging Experience<a class="headerlink" href="#improving-the-tagging-experience" title="Permalink to this headline">¶</a></h3>
<p>Right now, adding new tags is a difficult process, as the <code class="docutils literal"><span class="pre">TagsController</span></code>
disallows all access. Instead of allowing access, we can improve the tag
selection UI by using a comma separated text field. This will let us give
a better experience to our users, and use some more great features in the ORM.</p>
<div class="section" id="adding-a-computed-field">
<h4>Adding a Computed Field<a class="headerlink" href="#adding-a-computed-field" title="Permalink to this headline">¶</a></h4>
<p>Because we&#8217;ll want a simple way to access the formatted tags for an entity, we
can add a virtual/computed field to the entity. In
<strong>src/Model/Entity/Bookmark.php</strong> add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\Collection\Collection</span><span class="p">;</span>

<span class="k">protected</span> <span class="k">function</span> <span class="nf">_getTagString</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;tag_string&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;tag_string&#39;</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tags</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$tags</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Collection</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tags</span><span class="p">);</span>
    <span class="nv">$str</span> <span class="o">=</span> <span class="nv">$tags</span><span class="o">-&gt;</span><span class="na">reduce</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$string</span><span class="p">,</span> <span class="nv">$tag</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$string</span> <span class="o">.</span> <span class="nv">$tag</span><span class="o">-&gt;</span><span class="na">title</span> <span class="o">.</span> <span class="s1">&#39;, &#39;</span><span class="p">;</span>
    <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will let us access the <code class="docutils literal"><span class="pre">$bookmark-&gt;tag_string</span></code> computed property. We&#8217;ll
use this property in controls later on. Remember to add the <code class="docutils literal"><span class="pre">tag_string</span></code>
property to the <code class="docutils literal"><span class="pre">_accessible</span></code> list in your entity, as we&#8217;ll want to &#8216;save&#8217; it
later on.</p>
<p>In <strong>src/Model/Entity/Bookmark.php</strong> add the <code class="docutils literal"><span class="pre">tag_string</span></code> to <code class="docutils literal"><span class="pre">$_accessible</span></code>
this way:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">protected</span> <span class="nv">$_accessible</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;user_id&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;user&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;tags&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;tag_string&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
<span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="updating-the-views">
<h4>Updating the Views<a class="headerlink" href="#updating-the-views" title="Permalink to this headline">¶</a></h4>
<p>With the entity updated we can add a new control for our tags. In
<strong>src/Template/Bookmarks/add.ctp</strong> and <strong>src/Template/Bookmarks/edit.ctp</strong>,
replace the existing <code class="docutils literal"><span class="pre">tags._ids</span></code> control with the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">control</span><span class="p">(</span><span class="s1">&#39;tag_string&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="persisting-the-tag-string">
<h4>Persisting the Tag String<a class="headerlink" href="#persisting-the-tag-string" title="Permalink to this headline">¶</a></h4>
<p>Now that we can view existing tags as a string, we&#8217;ll want to save that data as
well. Because we marked the <code class="docutils literal"><span class="pre">tag_string</span></code> as accessible, the ORM will copy that
data from the request into our entity. We can use a <code class="docutils literal"><span class="pre">beforeSave()</span></code> hook method
to parse the tag string and find/build the related entities. Add the following
to <strong>src/Model/Table/BookmarksTable.php</strong>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">beforeSave</span><span class="p">(</span><span class="nv">$event</span><span class="p">,</span> <span class="nv">$entity</span><span class="p">,</span> <span class="nv">$options</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">tag_string</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">tags</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_buildTags</span><span class="p">(</span><span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">tag_string</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">protected</span> <span class="k">function</span> <span class="nf">_buildTags</span><span class="p">(</span><span class="nv">$tagString</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Trim tags</span>
    <span class="nv">$newTags</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="s1">&#39;trim&#39;</span><span class="p">,</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$tagString</span><span class="p">));</span>
    <span class="c1">// Remove all empty tags</span>
    <span class="nv">$newTags</span> <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$newTags</span><span class="p">);</span>
    <span class="c1">// Reduce duplicated tags</span>
    <span class="nv">$newTags</span> <span class="o">=</span> <span class="nb">array_unique</span><span class="p">(</span><span class="nv">$newTags</span><span class="p">);</span>

    <span class="nv">$out</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tags</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">where</span><span class="p">([</span><span class="s1">&#39;Tags.title IN&#39;</span> <span class="o">=&gt;</span> <span class="nv">$newTags</span><span class="p">]);</span>

    <span class="c1">// Remove existing tags from the list of new tags.</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$query</span><span class="o">-&gt;</span><span class="na">extract</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$existing</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$index</span> <span class="o">=</span> <span class="nb">array_search</span><span class="p">(</span><span class="nv">$existing</span><span class="p">,</span> <span class="nv">$newTags</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$index</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">unset</span><span class="p">(</span><span class="nv">$newTags</span><span class="p">[</span><span class="nv">$index</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Add existing tags.</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$query</span> <span class="k">as</span> <span class="nv">$tag</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$out</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$tag</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Add new tags.</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$newTags</span> <span class="k">as</span> <span class="nv">$tag</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$out</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tags</span><span class="o">-&gt;</span><span class="na">newEntity</span><span class="p">([</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nv">$tag</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$out</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>While this code is a bit more complicated than what we&#8217;ve done so far, it helps
to showcase how powerful the ORM in CakePHP is. You can manipulate query
results using the <a class="reference internal" href="core-libraries/collections.html"><span class="doc">Collections</span></a> methods, and handle
scenarios where you are creating entities on the fly with ease.</p>
</div>
</div>
<div class="section" id="wrapping-up">
<h3>Wrapping Up<a class="headerlink" href="#wrapping-up" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ve expanded our bookmarking application to handle authentication and basic
authorization/access control scenarios. We&#8217;ve also added some nice UX
improvements by leveraging the FormHelper and ORM capabilities.</p>
<p>Thanks for taking the time to explore CakePHP. Next, you can complete the
<a class="reference internal" href="tutorials-and-examples/blog/blog.html"><span class="doc">Blog Tutorial</span></a>, learn more about the
<a class="reference internal" href="orm.html"><span class="doc">Database Access &amp; ORM</span></a>, or you can peruse the <a class="reference internal" href="topics.html"><span class="doc">Using CakePHP</span></a>.</p>
</div>
</div>
</div>


            </div>
        </div>

        
        <div class="col-md-3 col-md-pull-9 hidden-xs hidden-sm" lang="en">
            <aside class="sidebar">
                <div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<p class="caption"><span class="caption-text">Preface</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">CakePHP at a Glance</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices/3-x-migration-guide.html">3.x Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/request-response.html">Request &amp; Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="orm.html">Database Access &amp; ORM</a></li>
</ul>
<p class="caption"><span class="caption-text">Using CakePHP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="controllers/components/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="bake.html">Bake Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/caching.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells.html">Console Tools, Shells &amp; Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/errors.html">Error &amp; Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/events.html">Events System</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/internationalization-and-localization.html">Internationalization &amp; Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/form.html">Modelless Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers/components/pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/rest.html">REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/sessions.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/validation.html">Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/app.html">App Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/file-folder.html">Folder &amp; File</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/hash.html">Hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/httpclient.html">Http Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/inflector.html">Inflector</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/registry-objects.html">Registry Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/time.html">Date &amp; Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/xml.html">Xml</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chronos.html">Chronos</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug-kit.html">Debug Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="elasticsearch.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade-tool.html">Upgrade Tool</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core-libraries/global-constants-and-functions.html">Constants &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>

</div>

                </div>
            </aside>
            <aside class="sidebar">
                <div class="mb30 row">
                </div>
            </aside>
        </div>
    </div>
</div>

<section id="socials" class="back-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-5  social text-center">
                <div class="col-sm-3 col-xs-3">
                    <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                          var js, fjs = d.getElementsByTagName(s)[0];
                          if (d.getElementById(id)) return;
                          js = d.createElement(s); js.id = id;
                          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
                          fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));
                        </script>
                        <div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-7 social-footer text-center ">
                <a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
                <a href="https://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
                <a href="https://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
                <a href="https://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
                <a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
                <a href="https://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
                <a href="https://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
                <a href="https://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
            </div>
        </div>
    </div>
</section>

<footer id="footer" class="footer-wrapper">
    <div class="container">

        <div class="row col-p30">
            <div class="col-sm-12 col-md-3">
                <div class="footer-widget t-footer">
                    <div class="col-md-12">
                        <a href="https://www.openhub.net/p/cakephp">
                            <img src="_static/open-hub.png">
                        </a>
                        <div class="mt10">
                            <a href="https://www.rackspace.com/">
                                <img src="_static/rackspace.png">
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12 col-md-9">
                <div class="col-md-3 col-sm-6 business-solution">
                    <ul class="footer-menu">
                        <li class="menu-title">
    <a href="https://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
    <a href="https://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center mt30">
                <p class="copyright">
                            &copy; Copyright 2017, Cake Software Foundation, Inc.
                        Last updated on Aug 30, 2017.
                        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
                </p>
            </div>
        </div>
    </div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-743287-3']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
  </body>
</html>