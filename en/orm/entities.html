

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Entities" lang="en" name="title" />
<meta content="entity, entities, single row, individual record" lang="en" name="keywords" />

    <title>Entities - 3.x</title>
    <link href="../_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="../_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="../_static/app.js"></script>

    <link rel="alternate" hreflang="pt_BR" href="../../pt/orm/entities.html" /><link rel="alternate" hreflang="es" href="../../es/orm/entities.html" /><link rel="alternate" hreflang="ja" href="../../ja/orm/entities.html" /><link rel="alternate" hreflang="fr" href="../../fr/orm/entities.html" /><link rel="alternate" hreflang="zh" href="../../zh/orm/entities.html" /><link rel="alternate" hreflang="tr" href="../../tr/orm/entities.html" /><link rel="alternate" hreflang="ru" href="../../ru/orm/entities.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 3.5 documentation" href="../_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 3.5 documentation" href="../index.html" />
    <link rel="up" title="Database Access &amp; ORM" href="../orm.html" />
    <link rel="next" title="Retrieving Data &amp; Results Sets" href="retrieving-data-and-resultsets.html" />
    <link rel="prev" title="Table Objects" href="table-objects.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
    
    <header class="nav-down">
        <div class="container-fluid hidden-xs hidden-sm">
            <div class="row">
                <div class="col-sm-3 col-md-3">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="../_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-9 col-md-9">
                    <nav class="navbar-right">
                        <ul class="menu">
                            <li class="first">
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
                                <ul class="submenu">
                                    
<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                                </ul>
                            </li>

                            <li><a href="https://cakephp.org/business-solutions">Business Solutions</a></li>
                            <li><a href="https://cakephp.org/writers">Get Paid To Write</a></li>
                            <li><a href="https://cakephp.org/pages/team">Team</a></li>

                            <li>
                                <a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
                                <div class="megamenu full">
                                    <div class="row">
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-6 pl30">
                                            <ul class="megamenu-list">
                                                
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

        
        <div class="container-fluid hidden-md hidden-lg">
            <div class="row">
                <div class="col-sm-6 col-xs-6">
                    <a class="logo-cake" href="https://cakephp.org">
                        <img src="../_static/logo-cake.png" alt="CakePHP" />
                    </a>
                </div>

                <div class="col-sm-6 col-xs-6">
                    <div class="navbar-right">
                        <button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
                            <i class="fa fa-bars toggle-modal"></i>
                        </button>
                    </div>
                    <div id="wrap">
                        <form class="search" action="../search.html" method="get">
                            <input name="q" type="search" placeholder="What are you looking for?">
                            <input id="search_submit" value="Search" type="submit">
                        </form>
                    </div>
                </div>
            </div>
        </div>

        
        <section id="nav-cook" class="hidden-xs hidden-sm">
            <div class="container-fluid ">
                <div class="row ">
                    <div class="col-md-12 back-book">
                        <div class="col-md-5 text-center t-cook-nav p0 hidden-sm hidden-xs">
                            <h2>
                                <a href="../contents.html">
                                    <span class="glyph_range icon-submenu icon-submenu-cook">B</span>
                                    CakePHP 3.5 Red Velvet <strong>Cookbook</strong>
                                </a>
                            </h2>
                        </div>

                        <div class="col-md-4 hidden-sm">
                            <form class="search" action="../search.html" method="get">
                                <input type="hidden" name="check_keywords" value="yes" />
                                <input type="hidden" name="area" value="default" />

                                <div class="col-md-10 p0">
                                    <input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
                                </div>
                                <div class="col-md-2 p0 search-cook">
                                    <button type="submit">
                                        <span class="glyph_range icon-submenu icon-submenu-cook">A</span>
                                    </button>
                                </div>
                            </form>
                        </div>

                        
                        <div class="col-md-3">
                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Language:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
                                                    role="button" aria-haspopup="true" aria-expanded="false" href="#">
                                                        en
                                                        <i class="fa fa-menu-en fa-chevron-down"></i>
                                                    </a>
                                            <ul class="dropdown-menu">
                                            
                                                <li></li>
                                            
                                                <li><a href="../../pt/orm/entities.html">pt</a></li>
                                            
                                                <li><a href="../../es/orm/entities.html">es</a></li>
                                            
                                                <li><a href="../../ja/orm/entities.html">ja</a></li>
                                            
                                                <li><a href="../../fr/orm/entities.html">fr</a></li>
                                            
                                                <li><a href="../../zh/orm/entities.html">zh</a></li>
                                            
                                                <li><a href="../../tr/orm/entities.html">tr</a></li>
                                            
                                                <li><a href="../../ru/orm/entities.html">ru</a></li>
                                            
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-md-6 p0">
                                <div class="col-md-7 t-language p0">
                                    <h6>Version:</h6>
                                </div>
                                <div class="col-md-5 p0">
                                    <ul class="nav navbar-nav">
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">3.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
                                            <ul class="dropdown-menu">
                                                <li><a href="https://book.cakephp.org/3.0/en">3.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/2.0/en">2.x Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.3/en/">1.3 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.2/en/">1.2 Book</a></li>
                                                <li><a href="https://book.cakephp.org/1.1/en">1.1 Book</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </section>
    </header>

    
    <section class="nav-btn visible-sm visible-xs">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
                </div>

                <div class="col-sm-6 col-xs-6 text-center">
                    <button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
                </div>
            </div>
        </div>
    </section>

    
    <div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title-cookbook" id="modal-header"></h4>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>

<div class="container page-container "><div id="improve-slideout">
        <i class="fa fa-pencil icon-improve"></i>
        <a href="https://github.com/cakephp/docs/edit/3.0/en/orm/entities.rst" target="_blank">
            <div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
        </a>
    </div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

    
    <div class="row">
        <div class="col-sm-12 col-md-9 col-md-push-3"><div class="page-contents col-sm-5">
                <h3>Page Contents</h3>
                <ul>
<li><a class="reference internal" href="#">Entities</a><ul>
<li><a class="reference internal" href="#creating-entity-classes">Creating Entity Classes</a></li>
<li><a class="reference internal" href="#creating-entities">Creating Entities</a></li>
<li><a class="reference internal" href="#accessing-entity-data">Accessing Entity Data</a></li>
<li><a class="reference internal" href="#accessors-mutators">Accessors &amp; Mutators</a><ul>
<li><a class="reference internal" href="#creating-virtual-properties">Creating Virtual Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#checking-if-an-entity-has-been-modified">Checking if an Entity Has Been Modified</a></li>
<li><a class="reference internal" href="#validation-errors">Validation Errors</a></li>
<li><a class="reference internal" href="#mass-assignment">Mass Assignment</a><ul>
<li><a class="reference internal" href="#avoiding-mass-assignment-protection">Avoiding Mass Assignment Protection</a></li>
<li><a class="reference internal" href="#modifying-the-guarded-fields-at-runtime">Modifying the Guarded Fields at Runtime</a></li>
<li><a class="reference internal" href="#bypassing-field-guarding">Bypassing Field Guarding</a></li>
<li><a class="reference internal" href="#checking-if-an-entity-was-persisted">Checking if an Entity was Persisted</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lazy-loading-associations">Lazy Loading Associations</a></li>
<li><a class="reference internal" href="#creating-re-usable-code-with-traits">Creating Re-usable Code with Traits</a></li>
<li><a class="reference internal" href="#converting-to-arrays-json">Converting to Arrays/JSON</a><ul>
<li><a class="reference internal" href="#exposing-virtual-properties">Exposing Virtual Properties</a></li>
<li><a class="reference internal" href="#hiding-properties">Hiding Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#storing-complex-types">Storing Complex Types</a></li>
</ul>
</li>
</ul>

            </div><div class="document-body">
            
  <div class="section" id="namespace-Cake\ORM">
<span id="entities"></span><h1>Entities<a class="headerlink" href="#namespace-Cake\ORM" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="Cake\ORM\Entity">
<em class="property">class </em><code class="descclassname">Cake\ORM\</code><code class="descname">Entity</code><a class="headerlink" href="#Cake\ORM\Entity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>While <a class="reference internal" href="table-objects.html"><span class="doc">Table Objects</span></a> represent and provide access to a collection of
objects, entities represent individual rows or domain objects in your
application. Entities contain persistent properties and methods to manipulate and
access the data they contain.</p>
<p>Entities are created for you by CakePHP each time you use <code class="docutils literal"><span class="pre">find()</span></code> on a table
object.</p>
<div class="section" id="creating-entity-classes">
<h2>Creating Entity Classes<a class="headerlink" href="#creating-entity-classes" title="Permalink to this headline">¶</a></h2>
<p>You don&#8217;t need to create entity classes to get started with the ORM in CakePHP.
However, if you want to have custom logic in your entities you will need to
create classes. By convention entity classes live in <strong>src/Model/Entity/</strong>. If
our application had an <code class="docutils literal"><span class="pre">articles</span></code> table we could create the following entity:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// src/Model/Entity/Article.php</span>
<span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Right now this entity doesn&#8217;t do very much. However, when we load data from our
articles table, we&#8217;ll get instances of this class.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you don&#8217;t define an entity class CakePHP will use the basic Entity class.</p>
</div>
</div>
<div class="section" id="creating-entities">
<h2>Creating Entities<a class="headerlink" href="#creating-entities" title="Permalink to this headline">¶</a></h2>
<p>Entities can be directly instantiated:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Model\Entity\Article</span><span class="p">;</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">();</span>
</pre></div>
</div>
<p>When instantiating an entity you can pass the properties with the data you want
to store in them:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Model\Entity\Article</span><span class="p">;</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">([</span>
    <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Article&#39;</span><span class="p">,</span>
    <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">(</span><span class="s1">&#39;now&#39;</span><span class="p">)</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>Another way of getting new entities is using the <code class="docutils literal"><span class="pre">newEntity()</span></code> method from the
<code class="docutils literal"><span class="pre">Table</span></code> objects:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Cake\ORM\TableRegistry</span><span class="p">;</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="nx">TableRegistry</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;Articles&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">newEntity</span><span class="p">();</span>
<span class="nv">$article</span> <span class="o">=</span> <span class="nx">TableRegistry</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;Articles&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">newEntity</span><span class="p">([</span>
    <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Article&#39;</span><span class="p">,</span>
    <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">(</span><span class="s1">&#39;now&#39;</span><span class="p">)</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-entity-data">
<h2>Accessing Entity Data<a class="headerlink" href="#accessing-entity-data" title="Permalink to this headline">¶</a></h2>
<p>Entities provide a few ways to access the data they contain. Most commonly you
will access the data in an entity using object notation:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Model\Entity\Article</span><span class="p">;</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">;</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">title</span> <span class="o">=</span> <span class="s1">&#39;This is my first post&#39;</span><span class="p">;</span>
<span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also use the <code class="docutils literal"><span class="pre">get()</span></code> and <code class="docutils literal"><span class="pre">set()</span></code> methods:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;This is my first post&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>When using <code class="docutils literal"><span class="pre">set()</span></code> you can update multiple properties at once using an array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">([</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My first post&#39;</span><span class="p">,</span>
    <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;It is the best ever!&#39;</span>
<span class="p">]);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When updating entities with request data you should whitelist which fields
can be set with mass assignment.</p>
</div>
</div>
<div class="section" id="accessors-mutators">
<h2>Accessors &amp; Mutators<a class="headerlink" href="#accessors-mutators" title="Permalink to this headline">¶</a></h2>
<p>In addition to the simple get/set interface, entities allow you to provide
accessors and mutator methods. These methods let you customize how properties
are read or set.</p>
<p>Accessors use the convention of <code class="docutils literal"><span class="pre">_get</span></code> followed by the CamelCased version of
the field name.</p>
<dl class="method">
<dt id="Cake\ORM\Entity::get">
<code class="descclassname">Cake\ORM\Entity::</code><code class="descname">get</code><span class="sig-paren">(</span><em>$field</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\ORM\Entity::get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>They receive the basic value stored in the <code class="docutils literal"><span class="pre">_properties</span></code> array
as their only argument. Accessors will be used when saving entities, so be
careful when defining methods that format data, as the formatted data will be
persisted. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_getTitle</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">ucwords</span><span class="p">(</span><span class="nv">$title</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The accessor would be run when getting the property through any of these two ways:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">;</span>
<span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can customize how properties get set by defining a mutator:</p>
<dl class="method">
<dt id="Cake\ORM\Entity::set">
<code class="descclassname">Cake\ORM\Entity::</code><code class="descname">set</code><span class="sig-paren">(</span><em>$field = null</em>, <em>$value = null</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\ORM\Entity::set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Mutator methods should always return the value that should be stored in the
property. As you can see above, you can also use mutators to set other
calculated properties. When doing this, be careful to not introduce any loops,
as CakePHP will not prevent infinitely looping mutator methods.</p>
<p>Mutators allow you to convert properties as they are set, or create calculated
data. Mutators and accessors are applied when properties are read using object
notation, or using <code class="docutils literal"><span class="pre">get()</span></code> and <code class="docutils literal"><span class="pre">set()</span></code>. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Cake\Utility\Text</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_setTitle</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Text</span><span class="o">::</span><span class="na">slug</span><span class="p">(</span><span class="nv">$title</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>The mutator would be run when setting the property through any of these two
ways:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">title</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span> <span class="c1">// slug is set as well</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">);</span> <span class="c1">// slug is set as well</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Accessors are also run before entities are persisted to the database.
If you want to transform fields but not persist that transformation,
we recommend using virtual properties as those are not persisted.</p>
</div>
<div class="section" id="creating-virtual-properties">
<span id="entities-virtual-properties"></span><h3>Creating Virtual Properties<a class="headerlink" href="#creating-virtual-properties" title="Permalink to this headline">¶</a></h3>
<p>By defining accessors you can provide access to fields/properties that do not
actually exist. For example if your users table has <code class="docutils literal"><span class="pre">first_name</span></code> and
<code class="docutils literal"><span class="pre">last_name</span></code> you could create a method for the full name:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_getFullName</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;  &#39;</span> <span class="o">.</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">];</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>You can access virtual properties as if they existed on the entity. The property
name will be the lower case and underscored version of the method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">full_name</span><span class="p">;</span>
</pre></div>
</div>
<p>Do bear in mind that virtual properties cannot be used in finds. If you want
virtual properties to be part of JSON or array representations of your entities,
see <a class="reference internal" href="#exposing-virtual-properties"><span class="std std-ref">Exposing Virtual Properties</span></a>.</p>
</div>
</div>
<div class="section" id="checking-if-an-entity-has-been-modified">
<h2>Checking if an Entity Has Been Modified<a class="headerlink" href="#checking-if-an-entity-has-been-modified" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\ORM\Entity::dirty">
<code class="descclassname">Cake\ORM\Entity::</code><code class="descname">dirty</code><span class="sig-paren">(</span><em>$field = null</em>, <em>$dirty = null</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\ORM\Entity::dirty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>You may want to make code conditional based on whether or not properties have
changed in an entity. For example, you may only want to validate fields when
they change:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// See if the title has been modified.</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">dirty</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can also flag fields as being modified. This is handy when appending into
array properties:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Add a comment and mark the field as changed.</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">comments</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$newComment</span><span class="p">;</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">dirty</span><span class="p">(</span><span class="s1">&#39;comments&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p>In addition you can also base your conditional code on the original property
values by using the <code class="docutils literal"><span class="pre">getOriginal()</span></code> method. This method will either return
the original value of the property if it has been modified or its actual value.</p>
<p>You can also check for changes to any property in the entity:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// See if the entity has changed</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">dirty</span><span class="p">();</span>
</pre></div>
</div>
<p>To remove the dirty mark from fields in an entity, you can use the <code class="docutils literal"><span class="pre">clean()</span></code>
method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">clean</span><span class="p">();</span>
</pre></div>
</div>
<p>When creating a new entity, you can avoid the fields from being marked as dirty
by passing an extra option:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">([</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Article&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;markClean&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">]);</span>
</pre></div>
</div>
<p>To get a list of all dirty properties of an <code class="docutils literal"><span class="pre">Entity</span></code> you may call:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$dirtyFields</span> <span class="o">=</span> <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">getDirty</span><span class="p">();</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.4.3: </span><code class="docutils literal"><span class="pre">getDirty()</span></code> has been added.</p>
</div>
</div>
<div class="section" id="validation-errors">
<h2>Validation Errors<a class="headerlink" href="#validation-errors" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="Cake\ORM\Entity::errors">
<code class="descclassname">Cake\ORM\Entity::</code><code class="descname">errors</code><span class="sig-paren">(</span><em>$field = null</em>, <em>$errors = null</em><span class="sig-paren">)</span><a class="headerlink" href="#Cake\ORM\Entity::errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>After you <a class="reference internal" href="saving-data.html#saving-entities"><span class="std std-ref">save an entity</span></a> any validation errors will be
stored on the entity itself. You can access any validation errors using the
<code class="docutils literal"><span class="pre">getErrors()</span></code> or <code class="docutils literal"><span class="pre">getError()</span></code> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get all the errors</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">getErrors</span><span class="p">();</span>
<span class="c1">// Prior to 3.4.0</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">();</span>

<span class="c1">// Get the errors for a single field.</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">getError</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">);</span>
<span class="c1">// Prior to 3.4.0</span>
<span class="nv">$errors</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">setErrors()</span></code> or <code class="docutils literal"><span class="pre">setError()</span></code> method can also be used to set the errors on an entity, making
it easier to test code that works with error messages:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">setError</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Password is required&#39;</span><span class="p">]);</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">setErrors</span><span class="p">([</span><span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;Password is required&#39;</span><span class="p">],</span> <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;Username is required&#39;</span><span class="p">]]);</span>
<span class="c1">// Prior to 3.4.0</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Password is required.&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="mass-assignment">
<span id="entities-mass-assignment"></span><h2>Mass Assignment<a class="headerlink" href="#mass-assignment" title="Permalink to this headline">¶</a></h2>
<p>While setting properties to entities in bulk is simple and convenient, it can
create significant security issues. Bulk assigning user data from the request
into an entity allows the user to modify any and all columns. When using
anonymous entity classes or creating the entity class with the <a class="reference internal" href="../bake.html"><span class="doc">Bake Console</span></a>
CakePHP does not protect against mass-assignment.</p>
<p>The <code class="docutils literal"><span class="pre">_accessible</span></code> property allows you to provide a map of properties and
whether or not they can be mass-assigned. The values <code class="docutils literal"><span class="pre">true</span></code> and <code class="docutils literal"><span class="pre">false</span></code>
indicate whether a field can or cannot be mass-assigned:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_accessible</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
    <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In addition to concrete fields there is a special <code class="docutils literal"><span class="pre">*</span></code> field which defines the
fallback behavior if a field is not specifically named:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$_accessible</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="s1">&#39;*&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
    <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the <code class="docutils literal"><span class="pre">*</span></code> property is not defined it will default to <code class="docutils literal"><span class="pre">false</span></code>.</p>
</div>
<div class="section" id="avoiding-mass-assignment-protection">
<h3>Avoiding Mass Assignment Protection<a class="headerlink" href="#avoiding-mass-assignment-protection" title="Permalink to this headline">¶</a></h3>
<p>When creating a new entity using the <code class="docutils literal"><span class="pre">new</span></code> keyword you can tell it to not
protect itself against mass assignment:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">App\Model\Entity\Article</span><span class="p">;</span>

<span class="nv">$article</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Article</span><span class="p">([</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Foo&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;guard&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-the-guarded-fields-at-runtime">
<h3>Modifying the Guarded Fields at Runtime<a class="headerlink" href="#modifying-the-guarded-fields-at-runtime" title="Permalink to this headline">¶</a></h3>
<p>You can modify the list of guarded fields at runtime using the <code class="docutils literal"><span class="pre">accessible</span></code>
method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Make user_id accessible.</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">accessible</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="c1">// Make title guarded.</span>
<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">accessible</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Modifying accessible fields effects only the instance the method is called
on.</p>
</div>
<p>When using the <code class="docutils literal"><span class="pre">newEntity()</span></code> and <code class="docutils literal"><span class="pre">patchEntity()</span></code> methods in the <code class="docutils literal"><span class="pre">Table</span></code>
objects you can customize mass assignment protection with options. Please refer
to the <a class="reference internal" href="saving-data.html#changing-accessible-fields"><span class="std std-ref">Changing Accessible Fields</span></a> section for more information.</p>
</div>
<div class="section" id="bypassing-field-guarding">
<h3>Bypassing Field Guarding<a class="headerlink" href="#bypassing-field-guarding" title="Permalink to this headline">¶</a></h3>
<p>There are some situations when you want to allow mass-assignment to guarded
fields:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$properties</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;guard&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">]);</span>
</pre></div>
</div>
<p>By setting the <code class="docutils literal"><span class="pre">guard</span></code> option to <code class="docutils literal"><span class="pre">false</span></code>, you can ignore the accessible
field list for a single call to <code class="docutils literal"><span class="pre">set()</span></code>.</p>
</div>
<div class="section" id="checking-if-an-entity-was-persisted">
<h3>Checking if an Entity was Persisted<a class="headerlink" href="#checking-if-an-entity-was-persisted" title="Permalink to this headline">¶</a></h3>
<p>It is often necessary to know if an entity represents a row that is already
in the database. In those situations use the <code class="docutils literal"><span class="pre">isNew()</span></code> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">isNew</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;This article was saved already!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you are certain that an entity has already been persisted, you can use
<code class="docutils literal"><span class="pre">isNew()</span></code> as a setter:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">isNew</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

<span class="nv">$article</span><span class="o">-&gt;</span><span class="na">isNew</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="lazy-loading-associations">
<span id="lazy-load-associations"></span><h2>Lazy Loading Associations<a class="headerlink" href="#lazy-loading-associations" title="Permalink to this headline">¶</a></h2>
<p>While eager loading associations is generally the most efficient way to access
your associations, there may be times when you need to lazily load associated
data. Before we get into how to lazy load associations, we should discuss the
differences between eager loading and lazy loading associations:</p>
<dl class="docutils">
<dt>Eager loading</dt>
<dd>Eager loading uses joins (where possible) to fetch data from the
database in as <em>few</em> queries as possible. When a separate query is required,
like in the case of a HasMany association, a single query is emitted to
fetch <em>all</em> the associated data for the current set of objects.</dd>
<dt>Lazy loading</dt>
<dd>Lazy loading defers loading association data until it is absolutely
required. While this can save CPU time because possibly unused data is not
hydrated into objects, it can result in many more queries being emitted to
the database. For example looping over a set of articles &amp; their comments
will frequently emit N queries where N is the number of articles being
iterated.</dd>
</dl>
<p>While lazy loading is not included by CakePHP&#8217;s ORM, you can just use one of the
community plugins to do so. We recommend <a class="reference external" href="https://github.com/jeremyharris/cakephp-lazyload">the LazyLoad Plugin</a></p>
<p>After adding the plugin to your entity, you will be able to do the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$article</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Articles</span><span class="o">-&gt;</span><span class="na">findById</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>

<span class="c1">// The comments property was lazy loaded</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$article</span><span class="o">-&gt;</span><span class="na">comments</span> <span class="k">as</span> <span class="nv">$comment</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$comment</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-re-usable-code-with-traits">
<h2>Creating Re-usable Code with Traits<a class="headerlink" href="#creating-re-usable-code-with-traits" title="Permalink to this headline">¶</a></h2>
<p>You may find yourself needing the same logic in multiple entity classes. PHP&#8217;s
traits are a great fit for this. You can put your application&#8217;s traits in
<strong>src/Model/Entity</strong>. By convention traits in CakePHP are suffixed with
<code class="docutils literal"><span class="pre">Trait</span></code> so they can be discernible from classes or interfaces. Traits are
often a good complement to behaviors, allowing you to provide functionality for
the table and entity objects.</p>
<p>For example if we had SoftDeletable plugin, it could provide a trait. This trait
could give methods for marking entities as &#8216;deleted&#8217;, the method <code class="docutils literal"><span class="pre">softDelete</span></code>
could be provided by a trait:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// SoftDelete/Model/Entity/SoftDeleteTrait.php</span>

<span class="k">namespace</span> <span class="nx">SoftDelete\Model\Entity</span><span class="p">;</span>

<span class="k">trait</span> <span class="nx">SoftDeleteTrait</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">softDelete</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;deleted&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>You could then use this trait in your entity class by importing it and including
it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">SoftDelete\Model\Entity\SoftDeleteTrait</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">SoftDeleteTrait</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-to-arrays-json">
<h2>Converting to Arrays/JSON<a class="headerlink" href="#converting-to-arrays-json" title="Permalink to this headline">¶</a></h2>
<p>When building APIs, you may often need to convert entities into arrays or JSON
data. CakePHP makes this simple:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Get an array.</span>
<span class="c1">// Associations will be converted with toArray() as well.</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>

<span class="c1">// Convert to JSON</span>
<span class="c1">// Associations will be converted with jsonSerialize hook as well.</span>
<span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
</pre></div>
</div>
<p>When converting an entity to an JSON the virtual &amp; hidden field lists are
applied. Entities are recursively converted to JSON as well. This means that if you
eager loaded entities and their associations CakePHP will correctly handle
converting the associated data into the correct format.</p>
<div class="section" id="exposing-virtual-properties">
<span id="id1"></span><h3>Exposing Virtual Properties<a class="headerlink" href="#exposing-virtual-properties" title="Permalink to this headline">¶</a></h3>
<p>By default virtual fields are not exported when converting entities to
arrays or JSON. In order to expose virtual properties you need to make them
visible. When defining your entity class you can provide a list of virtual
properties that should be exposed:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>

    <span class="k">protected</span> <span class="nv">$_virtual</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">];</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This list can be modified at runtime using <code class="docutils literal"><span class="pre">virtualProperties</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">virtualProperties</span><span class="p">([</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span> <span class="s1">&#39;is_admin&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="hiding-properties">
<h3>Hiding Properties<a class="headerlink" href="#hiding-properties" title="Permalink to this headline">¶</a></h3>
<p>There are often fields you do not want exported in JSON or array formats. For
example it is often unwise to expose password hashes or account recovery
questions. When defining an entity class, define which properties should be
hidden:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">App\Model\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Cake\ORM\Entity</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Entity</span>
<span class="p">{</span>

    <span class="k">protected</span> <span class="nv">$_hidden</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>

<span class="p">}</span>
</pre></div>
</div>
<p>This list can be modified at runtime using <code class="docutils literal"><span class="pre">hiddenProperties</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">hiddenProperties</span><span class="p">([</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;recovery_question&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="storing-complex-types">
<h2>Storing Complex Types<a class="headerlink" href="#storing-complex-types" title="Permalink to this headline">¶</a></h2>
<p>Accessor &amp; Mutator methods on entities are not intended to contain the logic for
serializing and unserializing complex data coming from the database. Refer to
the <a class="reference internal" href="saving-data.html#saving-complex-types"><span class="std std-ref">Saving Complex Types</span></a> section to understand how your application can
store more complex data types like arrays and objects.</p>
</div>
</div>


            </div>
        </div>

        
        <div class="col-md-3 col-md-pull-9 hidden-xs hidden-sm" lang="en">
            <aside class="sidebar">
                <div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<p class="caption"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">CakePHP at a Glance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/3-x-migration-guide.html">3.x Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/request-response.html">Request &amp; Response Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">Views</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../orm.html">Database Access &amp; ORM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="database-basics.html">Database Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="query-builder.html">Query Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="table-objects.html">Table Objects</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="retrieving-data-and-resultsets.html">Retrieving Data &amp; Results Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="saving-data.html">Saving Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="deleting-data.html">Deleting Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="associations.html">Associations - Linking Tables Together</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors.html">Behaviors</a></li>
<li class="toctree-l2"><a class="reference internal" href="schema-system.html">Schema System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../console-and-shells/orm-cache.html">ORM Cache Shell</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using CakePHP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../controllers/components/authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bake.html">Bake Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/caching.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console-and-shells.html">Console Tools, Shells &amp; Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/errors.html">Error &amp; Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/events.html">Events System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/internationalization-and-localization.html">Internationalization &amp; Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/form.html">Modelless Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/components/pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/rest.html">REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/sessions.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/validation.html">Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/app.html">App Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/collections.html">Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/file-folder.html">Folder &amp; File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/hash.html">Hash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/httpclient.html">Http Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/inflector.html">Inflector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/registry-objects.html">Registry Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/time.html">Date &amp; Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/xml.html">Xml</a></li>
</ul>
<p class="caption"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chronos.html">Chronos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug-kit.html">Debug Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elasticsearch.html">ElasticSearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade-tool.html">Upgrade Tool</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries/global-constants-and-functions.html">Constants &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices.html">Appendices</a></li>
</ul>

</div>

                </div>
            </aside>
            <aside class="sidebar">
                <div class="mb30 row">
                </div>
            </aside>
        </div>
    </div>
</div>

<section id="socials" class="back-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-5  social text-center">
                <div class="col-sm-3 col-xs-3">
                    <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                          var js, fjs = d.getElementsByTagName(s)[0];
                          if (d.getElementById(id)) return;
                          js = d.createElement(s); js.id = id;
                          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
                          fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));
                        </script>
                        <div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-7 social-footer text-center ">
                <a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
                <a href="https://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
                <a href="https://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
                <a href="https://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
                <a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
                <a href="https://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
                <a href="https://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
                <a href="https://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
            </div>
        </div>
    </div>
</section>

<footer id="footer" class="footer-wrapper">
    <div class="container">

        <div class="row col-p30">
            <div class="col-sm-12 col-md-3">
                <div class="footer-widget t-footer">
                    <div class="col-md-12">
                        <a href="https://www.openhub.net/p/cakephp">
                            <img src="../_static/open-hub.png">
                        </a>
                        <div class="mt10">
                            <a href="https://www.rackspace.com/">
                                <img src="../_static/rackspace.png">
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-12 col-md-9">
                <div class="col-md-3 col-sm-6 business-solution">
                    <ul class="footer-menu">
                        <li class="menu-title">
    <a href="https://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
    <a href="https://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="https://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Book</a></li>
<li><a href="https://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="https://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="https://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="https://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="https://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="https://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="https://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="https://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="https://github.com/FriendsOfCake/awesome-cakephp"><i class="fa fa-menu fa-chevron-right"></i>Featured Resources</a></li>
<li><a href="https://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="https://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="https://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
                    </ul>
                </div>

                <div class="col-md-3 col-sm-6">
                    <ul class="footer-menu">
                        
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="https://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="https://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="https://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="https://www.cakedc.com/"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center mt30">
                <p class="copyright">
                            &copy; Copyright 2017, Cake Software Foundation, Inc.
                        Last updated on Aug 30, 2017.
                        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
                </p>
            </div>
        </div>
    </div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-743287-3']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
  </body>
</html>